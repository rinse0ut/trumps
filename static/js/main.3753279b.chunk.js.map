{"version":3,"sources":["img/ant.jpeg","img/ben.jpeg","img/dan.jpeg","img/dt.jpeg","img/didun.jpeg","img/grant.jpeg","img/mike.jpeg","img/morgan.jpeg","img/nick.jpeg","img/pearce.jpeg","img/rob.jpeg","img/scouse.jpeg","img/stevooo.jpeg","img/sunny.jpeg","img/will.jpeg","img/vinnie.jpeg","services/firestore.js","components/AuthProvider.tsx","components/AuthRoute.tsx","components/Layout.tsx","components/SignUp.tsx","components/SignIn.tsx","components/SignOut.tsx","hooks/useCollection.tsx","components/Loading.tsx","auth/rules.tsx","auth/Can.tsx","components/List.tsx","pages/FriendsPage.tsx","pages/PackPage.tsx","hooks/useDocument.tsx","pages/StatsPage.tsx","forms/CardForm.tsx","components/CSVReader.tsx","pages/CardsPage.tsx","pages/ChallengePage.tsx","pages/MembershipPage.tsx","pages/GamesPage.tsx","components/Card.tsx","pages/GamePage.tsx","pages/AboutPage.tsx","components/Router.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","auth","db","storage","signInWithFacebook","facebookAuth","FacebookAuthProvider","console","log","signInWithPopup","signOut","getCollection","path","collection","defaultAuth","authenticated","user","uid","username","role","AuthContext","createContext","undefined","useAuthContext","value","useContext","Error","AuthProvider","children","useState","setAuth","id","a","doc","get","data","useEffect","unsubsribe","onAuthStateChanged","displayName","fetchUser","Provider","AuthRoute","Component","component","rest","render","routeProps","to","HeaderContainer","styled","header","H1","h1","HeaderLeft","div","HeaderRight","HeaderLink","Link","MainContainer","ContentContainer","Footer","TitleBar","createTeleporter","HeaderRightButton","Header","history","useHistory","location","useLocation","showBackButton","includes","pathname","onClick","goBack","Icon","name","size","inverted","Target","HeaderRightLink","Source","Layout","props","SignUp","firstname","lastname","email","password","error","setUser","handleChange","e","target","handleSubmit","preventDefault","createUserWithEmailAndPassword","result","updateProfile","set","myURL","url","sendEmailVerification","message","Container","Form","onSubmit","Field","htmlFor","type","placeholder","onChange","required","Button","primary","SignIn","push","signInWithEmailAndPassword","emailVerified","handleFacebookSignIn","additionalUserInfo","exists","photoURL","color","Segment","Logout","handleClick","useCollection","isSnapshot","setData","onSnapshot","snapshot","docs","ref","item","fetchData","map","LoadingContainer","Loading","loading","rules","visitor","static","dynamic","packGroupId","userGroupIds","moderator","creator","userId","packOwnerId","admin","Can","action","permissions","staticPermissions","dynamicPermissions","permissionCondition","check","perform","yes","no","defaultProps","DefaultListItem","title","description","List","Item","Content","ListItem","ListHeader","ListComponent","items","renderItem","divided","relaxed","length","FriendsPage","users","Image","avatar","src","InputCreate","setTitle","Input","add","stats","cards","group","author","PackPage","categories","Object","keys","useDcoument","InputEdit","categoryId","category","statKey","stat","updatedStat","update","cardKey","StatsPage","useParams","useDocument","entries","CardForm","card","useForm","defaultValues","register","errors","reset","imgUrl","setImgUrl","formData","cardId","updatedCateogry","JSON","parse","stringify","ImageField","file","setFile","files","disabled","Date","now","put","on","child","getDownloadURL","then","buttonRef","React","createRef","_CSVReader","handleOnFileLoad","handleOpenDialog","current","open","onFileLoad","onError","err","noClick","noDrag","onRemoveFile","style","display","flexDirection","marginBottom","borderWidth","borderStyle","borderColor","lineHeight","marginTop","marginRight","CardsPage","setError","rows","statKeys","fromEntries","reduce","row","i","statValues","forEach","key","panes","menuItem","sort","b","localeCompare","reverse","Tab","ChallengePage","player2Id","form","setForm","values","find","x","p2User","u","pack","p1Id","p1Username","p2Id","p2Username","p1TurnNumber","p2TurnNumber","turnNumber","created","groups","circular","MembershipPage","WideButton","GamesPage","games","filter","game","p1CardCount","turns","p1Cards","p2CardCount","p2Cards","icon","images","ant","ben","dan","didun","dt","grant","mike","morgan","nick","pearce","rob","scouse","stevooo","sunny","will","vinnie","Row","status","selectedKey","onSelectStat","player","isActive","Table","active","Cell","positive","negative","warning","Card","selectedStatKey","celled","unstackable","selectable","width","marginLeft","HeaderCell","toUpperCase","textAlign","countryCode","Flag","Body","colSpan","img","fluid","useGame","gameId","currentUsername","opponentUsername","currentPlayer","Math","floor","random","hand1","numCards","index","splice","deal","updateCards","drawCards","playerTurnNumber","currentTurn","setCurrentTurn","handleNextTurn","useCallback","nextTurn","updateTurn","turn","turnKey","getTurn","turnPlayer","getTurnCards","selectedStat","setSelectedStat","handleSelectStat","handleTurn","p1UpdatedCards","p2UpdatedCards","drawUpdatedCards","p1TopCard","p1HandCards","p2TopCard","p2HandCards","p1Value","Number","p2Value","nextPlayer","topCards","p1TopCardKey","p2TopCardKey","debug","turnId","turnNo","p1TurnNo","p2TurnNo","table","playerNum","StyledMessage","align","Message","GamePage","resultMsg","currentEmoji","opponentEmoji","currentCard","opponentCard","p1Color","p2Color","content","label","basic","pointing","AboutPage","href","HomePage","SignOut","Router","GameListPage","from","App","Boolean","window","hostname","match","ReactDOM","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"qFAAAA,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,kBCA3CD,EAAOC,QAAU,mqG,oBCAjBD,EAAOC,QAAU,IAA0B,oC,oBCA3CD,EAAOC,QAAU,IAA0B,oC,oBCA3CD,EAAOC,QAAU,IAA0B,mC,oBCA3CD,EAAOC,QAAU,IAA0B,qC,oBCA3CD,EAAOC,QAAU,IAA0B,mC,oBCA3CD,EAAOC,QAAU,IAA0B,qC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,qC,oBCA3CD,EAAOC,QAAU,IAA0B,sC,oBCA3CD,EAAOC,QAAU,IAA0B,oC,oBCA3CD,EAAOC,QAAU,IAA0B,mC,oBCA3CD,EAAOC,QAAU,IAA0B,qC,8RCiB3CC,gBAXuB,CACrBC,OAAQ,0CACRC,WAAY,+BACZC,YAAa,sCACbC,UAAW,eACXC,cAAe,2BACfC,kBAAmB,eACnBC,MAAO,4CACPC,cAAe,iBAKV,IAAMC,EAAOT,SACPU,EAAKV,cACLW,EAAUX,YAMVY,EAAoB,WAC/B,IAAMC,EAAe,IAAIb,OAAcc,qBAEvC,OADAC,QAAQC,IAAI,YACLhB,SAAgBiB,gBAAgBJ,IAalC,SAASK,IACd,OAAOT,EAAKS,UAOP,SAASC,EAAcC,GAC5B,OAAOV,EAAGW,WAAWD,GAOhB,ICnCDE,EAAwB,CAC5BC,eAAe,EACfC,KAAM,CACJC,IAAK,KACLC,SAAU,UACVC,KAAM,YAIGC,EAAcC,6BAAoCC,GAqDxD,SAASC,IACd,IAAMC,EAAQC,qBAAWL,GAEzB,GADAb,QAAQC,IAAI,yBAA0BgB,QACxBF,IAAVE,EACF,MAAM,IAAIE,MAAM,oCAElB,OAAOF,EAzDTjB,QAAQC,IAAI,qBAAsBY,GA4DnBO,MA1Df,YAA0C,IAAlBC,EAAiB,EAAjBA,SAAiB,EAEfC,mBAAmBf,GAFJ,mBAEhCb,EAFgC,KAE1B6B,EAF0B,iDAIvC,WAAyBC,GAAzB,iBAAAC,EAAA,sEACoBrB,EAAc,SAASsB,IAAIF,GAAIG,MADnD,OACQD,EADR,OAEQjB,EAAOiB,EAAIE,OACjB5B,QAAQC,IAAI,aAAcQ,GAC1Bc,EAAQ,CACNf,eAAe,EACfC,SANJ,4CAJuC,sBA0CvC,OA5BAoB,qBAAU,WACR,IAAMC,EDLH,SAA4BrB,GACjC,OAAOf,EAAKqC,mBAAmBtB,GCIVsB,EAAmB,SAACtB,GACrC,IAAMf,EAAiB,CACrBc,eAAe,EACfC,KAAM,CACJC,IAAG,OAAED,QAAF,IAAEA,OAAF,EAAEA,EAAMC,IACXC,SAAQ,OAAEF,QAAF,IAAEA,OAAF,EAAEA,EAAMuB,YAChBpB,KAAM,SAIVZ,QAAQC,IAAI,OAAQP,GACpBM,QAAQC,IAAI,OAAQQ,GAChBA,IA3B+B,oCA6BjCwB,CAAUxB,EAAKC,KAEfa,EAAQ7B,IAER6B,EAAQhB,MAGZ,OAAO,WACLgB,EAAQhB,GACRuB,OAED,IAGD,kBAACjB,EAAYqB,SAAb,CAAsBjB,MAAOvB,GAC1B2B,ICzDQc,MAhBf,YAAiE,IAAjCC,EAAgC,EAA3CC,UAAyBC,EAAkB,6BACvD9B,EAAiBQ,IAAjBR,cAEP,OADAR,QAAQC,IAAI,2BAA4BO,GAEtC,kBAAC,IAAD,iBACM8B,EADN,CAEEC,OAAQ,SAACC,GAAD,OACJhC,EACA,kBAAC4B,EAAcI,GAEf,kBAAC,IAAD,CAAUC,GAAG,iB,kqCCVvB,IAAMC,EAAkBC,IAAOC,OAAV,KAafC,EAAKF,IAAOG,GAAV,KAKFC,EAAaJ,IAAOK,IAAV,KAMVC,EAAcN,IAAOK,IAAV,KAMXE,EAAaP,YAAOQ,IAAPR,CAAH,KAKVS,EAAgBT,IAAOK,IAAV,KAMbK,EAAmBV,IAAOK,IAAV,KAITM,EAASX,IAAOK,IAAV,KAsBNO,EAAWC,cACXC,EAAoBD,cAejC,SAASE,IACP,IAAMC,EAAUC,cACVC,EAAWC,cACjB9D,QAAQC,IAAI,WAAY4D,GACxB,IAAME,GAAkB,CAAC,QAAS,UAAW,YAAYC,SAASH,EAASI,UAC3E,OACE,kBAACvB,EAAD,KACGqB,GAAkB,kBAAChB,EAAD,CAAYmB,QAAS,kBAAMP,EAAQQ,WAAU,kBAACC,EAAA,EAAD,CAAMC,KAAK,aAAaC,KAAK,QAAQC,UAAQ,KAC7G,kBAAC1B,EAAD,KAAI,kBAACU,EAASiB,OAAV,OACJ,kBAACvB,EAAD,KAAa,kBAACQ,EAAkBe,OAAnB,QAKZ,SAASC,GAAT,GAAyD,IAA/BhC,EAA8B,EAA9BA,GAAIpB,EAA0B,EAA1BA,SACnC,OACE,kBAACoC,EAAkBiB,OAAnB,KACE,kBAACxB,EAAD,CAAYT,GAAIA,GAAKpB,IAKZsD,OAnCf,SAAgBC,GAAmB,IAC1BvD,EAAYuD,EAAZvD,SAEP,OACE,kBAAC+B,EAAD,KACE,kBAACM,EAAD,MACA,kBAACL,EAAD,KACGhC,KCkBMwD,GAlGA,WAAM,MAEKvD,mBAAS,CAC/BwD,UAAW,GACXC,SAAU,GACVpE,SAAU,GACVqE,MAAO,GACPC,SAAU,GACVC,MAAO,KARU,mBAEZzE,EAFY,KAEN0E,EAFM,KAWnBnF,QAAQC,IAAI,WAIZ,IAAMmF,EAAe,SAACC,GAAY,IAAD,EAC/BF,EAAQ,2BACH1E,GADE,uBAEJ4E,EAAEC,OAAOjB,KAAOgB,EAAEC,OAAOrE,OAFrB,sBAGE,IAHF,MAQHsE,EAAY,uCAAG,WAAOF,GAAP,iBAAA5D,EAAA,6DACnB4D,EAAEG,iBADiB,kBJMAR,EIHWvE,EAAKuE,MJGTC,EIHgBxE,EAAKwE,SJI1CvF,EAAK+F,+BAA+BT,EAAOC,GIP7B,oBAGXS,EAHW,kBAIbA,OAJa,EAIbA,EAAQjF,MAJK,wBAKfT,QAAQC,IAAI,OAAQQ,GALL,SAMTiF,EAAOjF,KAAKkF,cAAc,CAC9B3D,YAAavB,EAAKE,WAPL,wBAUThB,EAAGW,WAAW,SAASoB,IAAIgE,EAAOjF,KAAKC,KAAKkF,IAAI,CACpDlF,IAAKgF,EAAOjF,KAAKC,IACjBoE,UAAWrE,EAAKqE,UAChBC,SAAUtE,EAAKsE,SACfpE,SAAUF,EAAKE,SACfqE,MAAOvE,EAAKuE,MACZpE,KAAM,SAhBO,eAoBTiF,EAAQ,CAAEC,IAAK,sCApBN,UAuBTJ,EAAOjF,KAAKsF,sBAAsBF,GAvBzB,QAyBfV,EAAQ,2BACH1E,GADE,IAELyE,MAAM,WAAD,OAAazE,EAAKE,SAAlB,8CAIPR,IA/Be,0DAmCjBgF,EAAQ,2BACH1E,GADE,IAELyE,MAAO,KAAEc,WArCM,kCJMhB,IAAgBhB,EAAOC,IINP,qBAAH,sDA0ClB,OACE,kBAACgB,EAAA,EAAD,KACE,kBAAC1C,EAASmB,OAAV,gBACA,6BACA,kBAACwB,EAAA,EAAD,CAAMC,SAAUZ,GACd,kBAACW,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAAQ,aAAf,cACA,2BAAOC,KAAK,OAAOC,YAAY,aAAalC,KAAK,YAAYmC,SAAUpB,EAAcqB,UAAQ,IAAG,8BAElG,kBAACP,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAAQ,YAAf,aACA,2BAAOC,KAAK,OAAOC,YAAY,YAAYlC,KAAK,WAAWmC,SAAUpB,EAAcqB,UAAQ,IAAG,8BAEhG,kBAACP,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAAQ,YAAf,YACA,2BAAOC,KAAK,OAAOC,YAAY,WAAWlC,KAAK,WAAWmC,SAAUpB,EAAcqB,UAAQ,IAAG,8BAE/F,kBAACP,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAAQ,SAAf,SACA,2BAAOC,KAAK,OAAOC,YAAY,QAAQlC,KAAK,QAAQmC,SAAUpB,EAAcqB,UAAQ,IAAG,8BAEzF,kBAACP,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAAQ,YAAf,YACA,2BAAOC,KAAK,WAAWC,YAAY,WAAWlC,KAAK,WAAWmC,SAAUpB,EAAcqB,UAAQ,IAAG,8BAErG,kBAACC,EAAA,EAAD,CAAQC,SAAO,EAACL,KAAK,UAArB,YAEE7F,EAAKyE,OAAS,4BAAKzE,EAAKyE,S,sNC1FTvC,IAAOK,IAAV,MAgHL4D,OAvGf,WAAmB,IAETpG,EAAkBQ,IAAlBR,cAEFmD,EAAUC,cAEZpD,GACFmD,EAAQkD,KAAK,SAPC,MAUQvF,mBAAS,CAC/B0D,MAAO,GACPC,SAAU,GACVC,MAAO,KAbO,mBAUTzE,EAVS,KAUH0E,EAVG,KAgBVC,EAAe,SAACC,GAAY,IAAD,EAC/BF,EAAQ,2BACH1E,GADE,uBAEJ4E,EAAEC,OAAOjB,KAAOgB,EAAEC,OAAOrE,OAFrB,sBAGE,IAHF,MAQHsE,EAAY,uCAAG,WAAOF,GAAP,iBAAA5D,EAAA,6DACnB4D,EAAEG,iBADiB,kBLHAR,EKMWvE,EAAKuE,MLNTC,EKMgBxE,EAAKwE,SLL1CvF,EAAKoH,2BAA2B9B,EAAOC,GKEzB,kBAGXS,EAHW,kBAIZA,GAJY,UAIZA,EAAQjF,YAJI,aAIZ,EAAcsG,cAJF,uBAKf5B,EAAQ,2BACH1E,GADE,IAELyE,MAAO,iDAPM,SAST/E,IATS,OAWjBwD,EAAQkD,KAAK,SAXI,kDAajB1B,EAAQ,2BACH1E,GADE,IAELyE,MAAO,KAAEc,WAfM,kCLHhB,IAAgBhB,EAAOC,IKGP,qBAAH,sDAoBZ+B,EAAoB,uCAAG,WAAO3B,GAAP,6BAAA5D,EAAA,+EAEJ5B,IAFI,UAEnB6F,EAFmB,8BAIvBP,EAAQ,2BAAI1E,GAAL,IAAWyE,MAAM,6BAJD,6BAOzBQ,GAAU1F,QAAQC,IAAI,KAAMyF,IACxBA,KAAM,OAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAQuB,oBARG,kCASL7G,EAAc,SAASsB,IAAvB,OAA2BgE,QAA3B,IAA2BA,GAA3B,UAA2BA,EAAQjF,YAAnC,aAA2B,EAAcC,KAAKiB,MATzC,WASjBD,EATiB,OAUvB1B,QAAQC,IAAI,WAAYyB,EAAIwF,QAVL,MAWtBxF,EAAIwF,QAXkB,uCAWFvH,EAAGW,WAAW,SAASoB,IAAvB,OAA2BgE,QAA3B,IAA2BA,GAA3B,UAA2BA,EAAQjF,YAAnC,aAA2B,EAAcC,KAAKkF,IAAI,CAErElF,IAAG,OAAEgF,QAAF,IAAEA,GAAF,UAAEA,EAAQjF,YAAV,aAAE,EAAcC,IACnBC,SAAQ,OAAE+E,QAAF,IAAEA,GAAF,UAAEA,EAAQjF,YAAV,aAAE,EAAcuB,YACxBgD,MAAK,OAAEU,QAAF,IAAEA,GAAF,UAAEA,EAAQjF,YAAV,aAAE,EAAcuE,MACrBmC,SAAQ,OAAEzB,QAAF,IAAEA,GAAF,UAAEA,EAAQjF,YAAV,aAAE,EAAc0G,SACxBvG,KAAM,SAjBe,QAoBzB+C,EAAQkD,KAAK,SApBY,kDAsBzB1B,EAAQ,2BACH1E,GADE,IAELyE,MAAO,KAAEc,WAxBc,0DAAH,sDA6B1B,OACI,kBAACC,EAAA,EAAD,KACE,kBAAC1C,EAASmB,OAAV,mBACA,kBAACD,GAAD,CAAiBhC,GAAG,WAApB,WACA,6BACA,kBAACyD,EAAA,EAAD,CAAMC,SAAUZ,GACd,kBAACW,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAAQ,SAAf,SACA,2BAAOC,KAAK,OAAOC,YAAY,QAAQlC,KAAK,QAAQmC,SAAUpB,EAAcqB,UAAQ,IAAG,8BAEzF,kBAACP,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAAQ,YAAf,YACA,2BAAOC,KAAK,WAAWC,YAAY,WAAWlC,KAAK,WAAWmC,SAAUpB,EAAcqB,UAAQ,IAAG,8BAEnG,kBAACC,EAAA,EAAD,CAAQC,SAAO,EAACL,KAAK,UAArB,YAKF,6BAAK,6BAAK,6BACV,kBAACI,EAAA,EAAD,CAAQU,MAAM,WAAWlD,QAAS8C,GAChC,kBAAC5C,EAAA,EAAD,CAAMC,KAAK,aADb,yBAIC5D,EAAKyE,OAAS,kBAACmC,GAAA,EAAD,CAASD,MAAM,OAAO3G,EAAKyE,SCnGnCoC,GAZA,WAGb,IAAMC,EAAW,uCAAG,sBAAA9F,EAAA,sEACZtB,IADY,2CAAH,qDAIjB,OACE,kBAACuG,EAAA,EAAD,CAAQJ,KAAK,SAASpC,QAASqD,GAA/B,Y,mBCqCWC,OAvCf,SAA0BnH,GAA4C,IAA9BoH,EAA6B,0DAC3CnG,qBAD2C,mBAC5DM,EAD4D,KACtD8F,EADsD,KAoCnE,OAjCA7F,qBAAU,WACR,GAAKxB,EAAL,CAEA,GAAIoH,EACF,OAAO9H,EAAGW,WAAWD,GAAMsH,YAAW,SAAAC,GACpC,IADgD,EAC1ChG,EAAY,GACZiG,EAAOD,EAASC,KAF0B,eAGhCA,GAHgC,IAGhD,2BAAsB,CAAC,IAAdnG,EAAa,QACpB1B,QAAQC,IAAR,kCAAuCyB,EAAIoG,IAAIzH,OAD3B,IAEbmB,EAAME,EAANF,GACDuG,EAAOrG,EAAIE,OACjBA,EAAKiF,KAAL,aAAWrF,MAAOuG,KAP4B,8BAShDL,EAAQ9F,OAbE,mCA8BdoG,GA9Bc,4CAiBd,8BAAAvG,EAAA,sEACyBrB,EAAcC,GAAMsB,MAD7C,OACQiG,EADR,OAEQhG,EAAOgG,EAASC,KAAKI,KAAI,SAAAvG,GAC7B1B,QAAQC,IAAI,MAAOyB,EAAIF,GAAIE,EAAIE,QADK,IAE7BJ,EAAME,EAANF,GACDI,EAAOF,EAAIE,OACjB,OAAO,aAACJ,MAAOI,MAEjB5B,QAAQC,IAAI,OAAQ2B,GAEpB8F,EAAQ9F,GAVV,4CAjBc,yBA+Bb,IAEIA,G,iMC1CT,IAAMsG,GAAmBvF,IAAOK,IAAV,MAgBPmF,OARf,WACE,OACE,kBAACD,GAAD,KACE,kBAAC9D,EAAA,EAAD,CAAMgE,SAAO,EAAC/D,KAAK,UAAUC,KAAK,UCkEzB+D,GAxEU,CACvBC,QAAS,CACPC,OAAQ,CACN,cACA,mBACA,oBAGJ9H,KAAM,CACJ8H,OAAQ,CACN,cACA,mBACA,cACA,iBAEFC,QAAS,CACP,YAAa,YAA8E,IAA5EC,EAA2E,EAA3EA,YAAaC,EAA8D,EAA9DA,aAE1B,OADA1I,QAAQC,IAAI,YAAa,CAACyI,eAAcD,gBACpB,WAAhBA,KACCC,IACL1I,QAAQC,IAAI,qBAAsByI,EAAa1E,SAASyE,IACjDC,EAAa1E,SAASyE,OAInCE,UAAW,CACTJ,OAAQ,CACN,cACA,mBACA,cACA,gBACA,eACA,cACA,eAGJK,QAAS,CACPL,OAAQ,CACN,cACA,mBACA,cACA,eACA,cACA,aACA,eACA,gBAEFC,QAAS,CACP,YAAa,YAAgE,IAA9DK,EAA6D,EAA7DA,OAAQC,EAAqD,EAArDA,YACrB,SAAKD,IAAWC,IACTD,IAAWC,KAIxBC,MAAO,CACLR,OAAQ,CACN,cACA,mBACA,cACA,gBACA,cACA,aACA,eACA,kBC1CN,SAASS,GAAIpE,GACX,OA7BF,SAAgByD,EAAkBzH,EAAcqI,EAAgBrH,GAC9D,IAAMsH,EAAcb,EAAMzH,GAC1B,IAAKsI,EAEH,OAAO,EAGT,IAAMC,EAAoBD,EAAYX,OAEtC,GAAIY,GAAqBA,EAAkBnF,SAASiF,GAElD,OAAO,EAGT,IAAMG,EAAqBF,EAAYV,QAEvC,GAAIY,EAAoB,CACtB,IAAMC,EAAsBD,EAAmBH,GAC/C,QAAKI,GAKEA,EAAoBzH,GAE7B,OAAO,EAIA0H,CAAMjB,GAAOzD,EAAMhE,KAAMgE,EAAM2E,QAAS3E,EAAMhD,MACjDgD,EAAM4E,MACN5E,EAAM6E,KAGZT,GAAIU,aAAe,CACjBF,IAAK,kBAAM,MACXC,GAAI,kBAAM,OAGGT,UCgBf,SAASW,GAAT,GAA0E,IAA/CC,EAA8C,EAA9CA,MAAOC,EAAuC,EAAvCA,YAAa/D,EAA0B,EAA1BA,IAC7C,OACE,kBAACgE,GAAA,EAAKC,KAAN,KACE,kBAACD,GAAA,EAAKE,QAAN,KACE,kBAACF,GAAA,EAAKpG,OAAN,KACGoC,EAAM,kBAAC,IAAD,CAAMrD,GAAIqD,GAAM8D,GAAgBA,GAExCC,IAMF,SAASI,GAAT,GAAsC,IAAlB5I,EAAiB,EAAjBA,SACzB,OACE,kBAACyI,GAAA,EAAKC,KAAN,KACE,kBAACD,GAAA,EAAKE,QAAN,KACG3I,IAMF,SAAS6I,GAAT,GAAwC,IAAlB7I,EAAiB,EAAjBA,SAC3B,OACE,kBAACyI,GAAA,EAAKpG,OAAN,KACGrC,GAKQ8I,OAzEf,YAAuE,IAA9C1J,EAA6C,EAA7CA,KAAMmJ,EAAuC,EAAvCA,MAAOQ,EAAgC,EAAhCA,MAAOC,EAAyB,EAAzBA,WAE3C,OAAKD,EAoBH,oCACE,kBAAC7G,EAASmB,OAAV,KAAkBkF,GAClB,kBAACvC,GAAA,EAAD,KACE,kBAACyC,GAAA,EAAD,CAAMQ,SAAO,EAACC,QAAQ,OAAOjG,KAAK,SAC/B8F,EAAMI,OAAS,EACZJ,EAAMnC,KAnBlB,SAAeF,GACb,OAAItH,GAAQsH,EAAKkB,OAEb,kBAAC,GAAD,CACErI,KAAI,OAAEH,QAAF,IAAEA,OAAF,EAAEA,EAAMG,KACZ2I,QAASxB,EAAKkB,OACdO,IAAK,kBAAMa,EAAaA,EAAWtC,GAAQ,kBAAC4B,GAAoB5B,MAI/DsC,EAAaA,EAAWtC,GAAQ,kBAAC4B,GAAoB5B,MAUlD,kBAACkC,GAAD,oBAxBR,kBAAC,GAAD,OCWSQ,OAxBf,WAEE,IAAMC,EAAQlD,GAAmB,SAEjC,OACE,kBAAC,GAAD,CACEoC,MAAM,uBACNQ,MAAOM,EACPL,WAAY,SAACtC,GAAD,OACV,kBAAC+B,GAAA,EAAKC,KAAN,KACE,kBAACY,GAAA,EAAD,CAAOC,QAAM,EAACC,IAAK9C,EAAKZ,WACxB,kBAAC2C,GAAA,EAAKE,QAAN,KACE,kBAACF,GAAA,EAAKpG,OAAN,KACGqE,EAAKpH,gBC4HpB,SAASmK,KAAe,IAAD,EACKxJ,mBAAS,IADd,mBACdsI,EADc,KACPmB,EADO,KAEbtK,EAASO,IAATP,KASR,OACE,kBAACyF,EAAA,EAAD,KACE,kBAACA,EAAA,EAAK8E,MAAN,KACE,2BACEzE,YAAY,uCACZtF,MAAO2I,EACPpD,SAAU,SAAAnB,GACR0F,EAAS1F,EAAEC,OAAOrE,QAEpBwF,UAAQ,KAGZ,kBAACC,EAAA,EAAD,CAAQU,MAAM,OAAOlD,QAnBzB,WACgB,KAAV0F,GAEFjK,EAAGW,WAAW,cAAc2K,IAAI,CAACrB,QAAOsB,MAAO,GAAIC,MAAO,GAAIC,MAAO,SAAUC,OAAM,OAAE5K,QAAF,IAAEA,OAAF,EAAEA,EAAME,aAgB7F,WAKS2K,OA/Ef,WAEE,IAAMC,EAAa/D,GAA4B,cAAc,GAI7D,OAFAxH,QAAQC,IAAI,OAAQsL,GAGlB,kBAACtF,EAAA,EAAD,KACE,kBAAC,GAAD,CACE2D,MAAM,qBACNQ,MAAOmB,EACPlB,WAAY,SAACtC,GAAD,OACV,kBAACkC,GAAD,KACE,kBAACC,GAAD,KACGnC,EAAK6B,OAER,kBAAC,IAAD,CAAMnH,GAAE,2BAAesF,QAAf,IAAeA,OAAf,EAAeA,EAAMvG,GAArB,WAAR,UACCxB,QAAQC,IAAI,OAAQuL,OAAOC,KAAK1D,EAAKmD,SACpCnD,EAAKmD,OAASM,OAAOC,KAAK1D,EAAKmD,OAAOV,OAAS,EAAI,0CAAK,kBAAC,IAAD,CAAM/H,GAAE,2BAAesF,QAAf,IAAeA,OAAf,EAAeA,EAAMvG,GAArB,WAAR,WAA4D,KAAK,6BAN7H,WAOWuG,EAAKsD,WAGpB,kBAACP,GAAD,QCnFSY,OA5Bf,SAAwBrL,EAAcmB,GAA0C,IAA9BiG,EAA6B,0DACrDnG,qBADqD,mBACtEM,EADsE,KAChE8F,EADgE,KAyB7E,OAvBA1H,QAAQC,IAAI,UAAW2B,GAEvBC,qBAAU,WACR,GAAKxB,EAAL,CAEA,GAAIoH,EACF,OAAO9H,EAAGW,WAAWD,GAAMqB,IAAIF,GAAImG,YAAW,SAAAC,GAC5C,IAAMhG,EAAOgG,EAAShG,OACtB5B,QAAQC,IAAI,YAAa2B,GACzB8F,EAAQ9F,OAPE,mCAkBdoG,GAlBc,4CAWd,8BAAAvG,EAAA,sEACoBrB,EAAcC,GAAMqB,IAAIF,GAAIG,MADhD,OACQD,EADR,OAEQE,EAAOF,EAAIE,OACjB5B,QAAQC,IAAI,aAAc2B,GAC1B8F,EAAQ9F,GAJV,4CAXc,yBAmBb,IAEIA,GCWT,SAAS+J,GAAT,GAAkE,IAA7CC,EAA4C,EAA5CA,WAAYC,EAAgC,EAAhCA,SAAUC,EAAsB,EAAtBA,QAASC,EAAa,EAAbA,KAAa,EACrCzK,mBAASyK,EAAKnC,OADuB,mBACxDA,EADwD,KACjDmB,EADiD,KAkB/D,OACE,oCACE,kBAAC7E,EAAA,EAAKE,MAAN,KACE,2BACEnF,MAAO2I,EACPpD,SAAU,SAAAnB,GACR0F,EAAS1F,EAAEC,OAAOrE,WAIxB,kBAACyF,EAAA,EAAD,CAAQU,MAAM,OAAOlD,QAzBzB,WACE,IAAM8H,EAA0C,GAChDA,EAAY,SAAD,OAAUF,IAAa,CAAElC,SACpCjK,EAAGW,WAAW,cAAcoB,IAAIkK,GAAYK,OAAOD,KAsBjD,UACA,kBAACtF,EAAA,EAAD,CAAQU,MAAM,MAAMlD,QApBxB,WAGE,IAAK,IAAIgI,YAFFL,EAASX,MAAMY,GAEFD,EAASV,aACpBU,EAASV,MAAMe,GAASJ,GAEjCnM,EAAGW,WAAW,cAAcoB,IAAIkK,GAAYhG,IAAIiG,KAc9C,UACA,6BAAK,8BAKX,SAASf,GAAT,GAAgG,IAAzEc,EAAwE,EAAxEA,WAAYC,EAA4D,EAA5DA,SAA4D,EACnEvK,mBAAiB,IADkD,mBACtFsI,EADsF,KAC/EmB,EAD+E,KAS7F,OACE,oCACE,kBAAC7E,EAAA,EAAKE,MAAN,KACE,2BACEnF,MAAO2I,EACPrD,YAAY,WACZC,SAAU,SAAAnB,GACR0F,EAAS1F,EAAEC,OAAOrE,WAIxB,kBAACyF,EAAA,EAAD,CAAQU,MAAM,OAAOlD,QAjBzB,WACE2H,EAASX,MAAMtB,GAAS,CAAEA,SAC1BjK,EAAGW,WAAW,cAAcoB,IAAIkK,GAAYhG,IAAIiG,GAChDd,EAAS,MAcP,UACA,6BAAK,8BAKIoB,OA1Ff,WAAsB,IAEZP,EAAeQ,cAAfR,WACFC,EAAWQ,GAA0B,aAAcT,GAAY,GAGrE,OAFA5L,QAAQC,IAAI,iBAAkB4L,GAEzBA,EAOH,kBAAC5F,EAAA,EAAD,KACE,kBAAC1C,EAASmB,OAAV,cACA,4GACA,kBAACwB,EAAA,EAAD,KACE,kBAAC,GAAD,CAAa0F,WAAYA,EAAYC,SAAUA,IAC/C,6BACA,6BACCA,EAASX,OAASM,OAAOc,QAAQT,EAASX,OACxCjD,KAAI,mCAAE6D,EAAF,KAAWC,EAAX,YACL,kBAACJ,GAAD,CAAWC,WAAYA,EAAYC,SAAUA,EAAUC,QAASA,EAASC,KAAMA,SAdnF,kBAAC,GAAD,O,8HCTN,IAAM5K,GAAQwB,IAAOK,IAAV,MAoGIuJ,OAlFf,YAA4D,IAAzCX,EAAwC,EAAxCA,WAAYC,EAA4B,EAA5BA,SAAUW,EAAkB,EAAlBA,KAAkB,EACNC,aAAQ,CAACC,cAAeF,IAAlEG,EADgD,EAChDA,SAAUC,EADsC,EACtCA,OAAQC,EAD8B,EAC9BA,MAAOtH,EADuB,EACvBA,aADuB,EAE7BjE,oBAAa,OAAJkL,QAAI,IAAJA,OAAA,EAAAA,EAAMM,SAAU,IAFI,mBAElDA,EAFkD,KAE1CC,EAF0C,iDAMzD,WAAwBC,GAAxB,iBAAAvL,EAAA,6DACEuL,EAAQ,OAAaF,EACfG,EAAUT,EAAyDA,EAAKhL,GAA/D,cAAegK,OAAOC,KAAKI,EAASV,OAAOX,OAAS,GACnEwC,EAASxL,GAAKyL,EACdpB,EAASV,MAAM8B,GAAUD,EAJ3B,SAKuBrN,EAAGW,WAAW,cAAcoB,IAAIkK,GAAYhG,IAAIiG,GALvE,OAKQnG,EALR,OAME1F,QAAQC,IAAI,SAAUyF,GACjB8G,GACHK,IARJ,4CANyD,kEAkBzD,4BAAApL,EAAA,0DACM+K,EADN,uBAEIxM,QAAQC,IAAI,eAAgBuM,EAAKhL,GAAIgL,GAC/BU,EAAkBC,KAAKC,MAAMD,KAAKE,UAAUxB,WAC5BqB,EAAe,MAAUV,EAAKhL,IACpDxB,QAAQC,IAAI,kBAAmBiN,GALnC,SAOUvN,EAAGW,WAAW,cAAcoB,IAAIkK,GAAYhG,IAAIsH,GAP1D,4CAlByD,sBA6BzD,OA1BAlN,QAAQC,IAAI,SAAUuM,GAAOA,GA2B3B,kBAACtG,EAAA,EAAD,KACE,kBAACA,EAAA,EAAKE,MAAN,KACE,wCACA,2BACE/B,KAAK,QACLyD,IAAK6E,EAAS,CAAElG,UAAU,MAE3BmG,EAAOhD,OAAS,kBAAC,GAAD,2BAEnB,6BACA,kBAAC1D,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAAQ,eAAf,gBACA,4BACEhC,KAAK,cACLyD,IAAK6E,GAEL,4BAAQ1L,MAAM,IAAd,aACA,4BAAQA,MAAM,MAAd,YACA,4BAAQA,MAAM,MAAd,UACA,4BAAQA,MAAM,MAAd,UACA,4BAAQA,MAAM,UAAd,YACA,4BAAQA,MAAM,MAAd,MACA,4BAAQA,MAAM,MAAd,OACA,4BAAQA,MAAM,UAAd,WAGJ,6BACA,kBAACiF,EAAA,EAAKE,MAAN,KACE,kBAACkH,GAAD,CAAYR,OAAQA,EAAQC,UAAWA,KAEzC,6BACEvB,OAAOc,QAAQT,EAASX,OAAOjD,KAAI,mCAAE6D,EAAF,KAAWC,EAAX,YACnC,oCACE,kBAAC7F,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAASyF,GAAUC,EAAKnC,OAC/B,2BACErD,YAAawF,EAAKnC,MAClBvF,KAAMyH,EACNxF,KAAK,SACLwB,IAAK6E,EAAS,CAAElG,UAAU,MAE3BmG,EAAOd,IAAY,kBAAC,GAAD,KAAQC,EAAKnC,MAAb,iBAEtB,iCAGJ,kBAAClD,EAAA,EAAD,CAAQU,MAAM,OAAOlD,QAASqB,GA5EuB,+CA4EEiH,EAAO,SAAW,UACxEA,GAAQ,kBAAC9F,EAAA,EAAD,CAAQU,MAAM,MAAMlD,QA7EwB,4CA6E5C,YAOf,SAASoJ,GAAT,GAA+C,IAA1BR,EAAyB,EAAzBA,OAAQC,EAAiB,EAAjBA,UAAiB,EACpBzL,mBAAc,MADM,mBACrCiM,EADqC,KAC/BC,EAD+B,KAwB5C,OACE,6BACE,kBAAC7C,GAAA,EAAD,CAAOE,IAAKiC,IACZ,2BAAOxG,KAAK,OAAOE,SAxBvB,SAAsBnB,GACpBmI,EAAQnI,EAAEC,OAAOmI,MAAM,OAwBrB,kBAAC/G,EAAA,EAAD,CAAQC,SAAO,EAAC+G,UAAWH,EAAMrJ,QArBrC,SAAsBmB,GACpBA,EAAEG,iBACFxF,QAAQC,IAAI,cAAesN,EAAMA,GACpBI,KAAKC,MACGhO,EAAQkI,IAAR,kBAAuByF,EAAKlJ,OAAQwJ,IAAIN,GAChDO,GAAG,gBAAiB9N,QAAQC,IAAKD,QAAQkF,OAAO,WACzDtF,EACGkI,IAAI,UACJiG,MAAMR,EAAKlJ,MACX2J,iBACAC,MAAK,SAACnI,GACL0H,EAAQ,MACRT,EAAUjH,WAShB,iB,cClIAoI,GAAiBC,IAAMC,YAEd,SAASC,GAAT,GAAoD,IAA/BC,EAA8B,EAA9BA,iBAC5BC,EAAmB,SAAClJ,GAEpB6I,GAAUM,SACZN,GAAUM,QAAQC,KAAKpJ,IAqBzB,OACE,kBAAC,KAAD,CACEyC,IAAKoG,GACLQ,WAAYJ,EACZK,QArBgB,SAACC,GACrB5O,QAAQC,IAAI2O,IAqBRC,SAAO,EACPC,QAAM,EACNC,aApBqB,SAACnN,GAC1B5B,QAAQC,IAAI,+BACZD,QAAQC,IAAI2B,GACZ5B,QAAQC,IAAI,kCAmBP,gBAAGsN,EAAH,EAAGA,KAAH,OACC,2BACEyB,MAAO,CACLC,QAAS,OACTC,cAAe,MACfC,aAAc,KAGhB,yBACEH,MAAO,CACLI,YAAa,EACbC,YAAa,QACbC,YAAa,OACbC,WAAY,IACZC,UAAW,EACXL,aAAc,EACdM,YAAa,IAGdlC,GAAQA,EAAKlJ,MAEhB,kBAACqC,EAAA,EAAD,CACEC,SAAO,EACPzC,QAASqK,GAFX,uBCqNGmB,OAzQf,WAAsB,IAEZ9D,EAAeQ,cAAfR,WACFC,EAAWQ,GAA0B,aAAcT,GAHtC,EAIOtK,mBAAsB,MAJ7B,mBAIZ4D,EAJY,KAILyK,EAJK,KASnB,IAAK9D,EACH,OACE,kBAAC,GAAD,MAXe,SAeJyC,EAfI,8EAenB,WAAgC1M,GAAhC,2BAAAH,EAAA,sEAGIkO,EAAS,MAHb,eAI8B/N,GAAnBgB,EAJX,KAIsBgN,EAJtB,0BAKiChN,EAAOhB,MALxC,KAKqBiO,EALrB,WAOU3E,EAAQM,OAAOsE,YAAYD,EAAS5H,KAAI,SAAC8D,GAAD,MAAkB,CAACA,EAAM,CAAEnC,MAAOmC,QAE1EZ,EAAQyE,EAAKG,QAAO,SAAC5E,EAAY6E,EAAUC,GAAe,IAAD,eAC9BD,EAAIpO,MAA5BgI,EADsD,KAC5CsG,EAD4C,WAE7DlQ,QAAQC,IAAI2J,EAAOsG,GACnB,IAAMjD,EAAM,cAAUgD,EAAI,GAK1B,OAJA9E,EAAM8B,GAAU,CAAEzL,GAAIyL,EAAQrD,SAC9BiG,EAASM,SAAQ,SAACC,EAAaH,GAC7B9E,EAAM8B,GAAQmD,GAAOF,EAAWD,MAE3B9E,IACN,IAlBP,SAmByBxL,EAAGW,WAAW,cAAcoB,IAAIkK,GAAYhG,IAAI,CAAEgE,MAAK,OAAEiC,QAAF,IAAEA,OAAF,EAAEA,EAAUjC,MAAOsB,QAAOC,UAnB1G,gEAqBInL,QAAQkF,MAAM,sBAAd,MACAyK,EAAS,gDAtBb,2DAfmB,sBAuDnB,IAAMU,EAAQ,CACZ,CACEC,SAAU,SAAU/N,OAAQ,kBAC1B,kBAAC0D,EAAA,EAAD,KACE,kBAAC,GAAD,CAAU2F,WAAYA,EAAYC,SAAUA,OAIlD,CACEyE,SAAS,SAAD,OAAW9E,OAAOC,KAAKI,EAASV,OAAOX,OAAvC,KAAkDjI,OAAQ,kBAChE,kBAAC0D,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,KACGsF,OAAOc,QAAQT,EAASV,OACtBoF,MAAK,SAAC9O,EAAG+O,GAAJ,OAAUA,EAAE,GAAGC,cAAchP,EAAE,OACpCiP,UACAzI,KAAI,mCAAWuE,GAAX,kBAEH,oCACE,kBAAC,GAAD,CAAUZ,WAAYA,EAAYC,SAAUA,EAAUW,KAAMA,IAC5D,qCAOd,CACE8D,SAAU,aAAc/N,OAAQ,kBAC9B,kBAAC0D,EAAA,EAAD,KACE,6BACA,kDACA,kBAACoB,GAAA,EAAD,0CACoC,6BADpC,kBAEiB,6BAFjB,kBAGiB,8BAEjB,kBAAC,GAAD,CACEiH,iBAAkBA,QAa5B,OACE,oCACGpJ,GAAS,kBAACmC,GAAA,EAAD,CAAS9C,UAAQ,EAAC6C,MAAM,OAAOlC,GACzC,kBAAC3B,EAASmB,OAAV,KAAkBmH,EAASjC,OAC3B,kBAAC+G,GAAA,EAAD,CAAKN,MAAOA,MClBHO,OA9Ff,WAA0B,IAEhBnQ,EAASO,IAATP,KACFkD,EAAUC,cACV2H,EAAa/D,GAA4B,cACzCkD,EAAQlD,GAAmB,SALV,EAOClG,mBAAuB,CAAEsK,WAAY,GAAIiF,UAAW,KAPrD,mBAOhBC,EAPgB,KAOVC,EAPU,KASjB3L,EAAe,SAACC,GACpB0L,EAAQ,2BACHD,GADE,kBAEJzL,EAAEC,OAAOjB,KAAOgB,EAAEC,OAAOrE,UAZP,4CAgBvB,gCAAAQ,EAAA,2DACQoK,EAAWN,GAAcC,OAAOwF,OAAOzF,GAAY0F,MAAK,SAAAC,GAAC,OAAIA,EAAE1P,KAAOsP,EAAKlF,iBACjEnL,EAFlB,uBAGU0Q,EAHV,OAGmBzG,QAHnB,IAGmBA,OAHnB,EAGmBA,EAAOuG,MAAK,SAAAG,GAAC,OAAIA,EAAE5P,KAAOsP,EAAKD,aAHlD,SAIsBlR,EAAGW,WAAW,SAAS2K,IAAI,CAC3CoG,KAAMxF,EACNyF,KAAM7Q,EAAKC,IACX6Q,WAAY9Q,EAAKE,SACjB6Q,KAAMV,EAAKD,UACXY,WAAYN,EAAOxQ,SACnB+Q,aAAc,EACdC,aAAc,EACdC,WAAY,EACZC,QAASlE,KAAKC,QAbpB,OAIUlM,EAJV,OAeIiC,EAAQkD,KAAR,gBAAsBnF,EAAIF,KAf9B,4CAhBuB,sBAwCvB,OAHAxB,QAAQC,IAAI,iBAAkB6Q,GAC9B9Q,QAAQC,IAAI,iBAAkBsL,EAAYb,GAErCa,GAAeb,EAOlB,kBAACzE,EAAA,EAAD,KACE,kBAAC1C,EAASmB,OAAV,kBACA,6BAAM,6BACN,kBAACwB,EAAA,EAAD,KACE,kBAACA,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAAQ,aAAf,UACA,4BACEhC,KAAK,YACLpD,MAAO6P,EAAKD,UACZrK,SAAUpB,GAEV,4BAAQnE,MAAM,IAAd,aACCuK,OAAOwF,OAAOtG,GAAOzC,KAAI,SAACiJ,GAAD,OACxB,4BAAQjQ,MAAOiQ,EAAE1P,IAAK0P,EAAEvQ,eAI9B,kBAACuF,EAAA,EAAKE,MAAN,KACE,2BAAOC,QAAQ,cAAf,QACA,4BACEhC,KAAK,aACLpD,MAAO6P,EAAKlF,WACZpF,SAAUpB,GAEV,4BAAQnE,MAAM,IAAd,aACCuK,OAAOwF,OAAOzF,GAAYtD,KAAI,SAACoJ,GAAD,OAC7B,kBAAC,GAAD,CACEzQ,KAAI,OAAEH,QAAF,IAAEA,OAAF,EAAEA,EAAMG,KACZ2I,QAAQ,YACR3H,KAAM,CACJ6G,YAAW,OAAE4I,QAAF,IAAEA,OAAF,EAAEA,EAAMjG,MACnB1C,aAAY,OAAEjI,QAAF,IAAEA,OAAF,EAAEA,EAAMqR,QAEtBtI,IAAK,kBACH,4BAAQvI,MAAOoQ,EAAK7P,IAAK6P,EAAKzH,gBAO1C,6BACA,kBAAClD,EAAA,EAAD,CAAQU,MAAM,MAAM2K,UAAQ,EAAC7N,QAzFV,4CAyFnB,oBA/CA,kBAAC,GAAD,OClBS8N,OA/Bf,WACE,OACE,kBAAC/L,EAAA,EAAD,KACE,kBAAC1C,EAASmB,OAAV,mBACA,6BACA,sEACA,4BACE,kEAEF,4CACA,4BACE,iEACA,yEAEF,uDACA,4BACE,iEACA,wEACA,kDAEF,qDACA,4BACE,iEACA,wEACA,iDACA,0D,yFClBR,IAAMuN,GAAatP,YAAO+D,IAAP/D,CAAH,MA6CDuP,OAzCf,WAEE,IAAMvO,EAAUC,cACTnD,EAAQO,IAARP,KACD0R,EAAQ3K,GAAmB,SAAS,GACpC4C,EAAK,OAAG+H,QAAH,IAAGA,OAAH,EAAGA,EAAOC,QAAO,SAACC,GAK3B,OADoB,OAAJ5R,QAAI,IAAJA,OAAA,EAAAA,EAAMC,OAAQ2R,EAAKf,OAAY,OAAJ7Q,QAAI,IAAJA,OAAA,EAAAA,EAAMC,OAAQ2R,EAAKb,QAG/DjB,MAAK,SAAC9O,EAAG+O,GAAJ,OAAWA,EAAEqB,QAAUpQ,EAAEoQ,WAC9B5J,KAAI,SAACoK,GAAoB,IAAD,UACjBC,EAAW,UAAGD,EAAKE,MAAL,cAAkBF,EAAKT,oBAA1B,iBAAG,EAAsCY,eAAzC,aAAG,EAA+ChI,OAC7DiI,EAAW,UAAGJ,EAAKE,MAAL,cAAkBF,EAAKT,oBAA1B,iBAAG,EAAsCc,eAAzC,aAAG,EAA+ClI,OACnE,MAAO,CACLZ,MAAM,GAAD,cAAKyI,QAAL,IAAKA,OAAL,EAAKA,EAAMd,WAAX,aAA0Be,EAA1B,uBAA6CD,QAA7C,IAA6CA,OAA7C,EAA6CA,EAAMZ,WAAnD,aAAkEgB,EAAlE,KACL5I,YAAY,GAAD,cAAKwI,QAAL,IAAKA,GAAL,UAAKA,EAAMhB,YAAX,aAAK,EAAYzH,MAAjB,0BAAiCyI,QAAjC,IAAiCA,OAAjC,EAAiCA,EAAMT,YAClD9L,IAAI,SAAD,cAAWuM,QAAX,IAAWA,OAAX,EAAWA,EAAM7Q,QAIxB,OACE,oCACE,kBAAC,GAAD,CAAMoI,MAAM,qBAAWQ,MAAOA,EAAO3J,KAAMA,IAC3C,kBAAC6C,EAAD,KACE,kBAAC2O,GAAD,CACE7K,MAAM,MACNuL,KAAK,MACLrO,KAAK,OACLyN,UAAQ,EACR7N,QAAS,kBAAMP,EAAQkD,KAAR,gBALjB,e,6WClBF+L,GAAqB,CACzBC,SAAKC,SAAKC,SAAKC,WAAOC,QAAIC,WAAOC,UAAMC,YAAQC,UAAMC,YAAQC,SAAKC,YAAQC,aAASC,WAAOC,UAAMC,aA2ElG,SAASC,GAAIjP,GAAqB,IAG5BkP,EAFGlK,EAAoEhF,EAApEgF,MAAO3I,EAA6D2D,EAA7D3D,MAAO6K,EAAsDlH,EAAtDkH,QAASiI,EAA6CnP,EAA7CmP,YAAaC,EAAgCpP,EAAhCoP,aAActO,EAAkBd,EAAlBc,OAAQuO,EAAUrP,EAAVqP,OAC7DC,GAAW,EAcf,OAZIpI,IAAYiI,GAAyB,MAAVrO,EAC7BwO,GAAW,EAEXJ,EADShI,IAAYiI,GAA0B,IAAXrO,EAC3B,UACAoG,IAAYiI,GAAerO,IAAWuO,EACtC,WACAnI,IAAYiI,GAAerO,IAAWuO,EACtC,gBAEAlT,EAEXf,QAAQC,IAAI,SAAU8T,IAAgBjI,EAASiI,EAAajI,GAE1D,kBAACqI,GAAA,EAAMN,IAAP,CAAWzD,IAAKtE,EAAS5H,QAAS8P,EAAcI,OAAQF,GACtD,kBAACG,GAAD,CAAMP,OAAQA,GACXlK,GAEH,kBAACyK,GAAD,CAAMP,OAAQA,GACX7S,IAWT,SAASoT,GAAKzP,GAAsB,IAC1BkP,EAAqBlP,EAArBkP,OAAQzS,EAAauD,EAAbvD,SAChB,OACE,kBAAC8S,GAAA,EAAME,KAAP,CACEC,SAAqB,aAAXR,EACVS,SAAqB,aAAXT,EACVU,QAAoB,YAAXV,GAERzS,GAKQoT,OA1Gf,SAAc7P,GAAsB,IAC1B4H,EAA2D5H,EAA3D4H,KAAMtB,EAAqDtG,EAArDsG,MAAOwJ,EAA8C9P,EAA9C8P,gBAAiBT,EAA6BrP,EAA7BqP,OAAQvO,EAAqBd,EAArBc,OAAQgI,EAAa9I,EAAb8I,SACtD,OACE,kBAACyG,GAAA,EAAD,CAAOQ,QAAM,EAACC,aAAW,EACvBtQ,KAAK,QACLuQ,YAAanH,EACbsB,MAAO,CAAE8F,MAAO,MAAOC,WAAY,IAEnC,kBAACZ,GAAA,EAAMzQ,OAAP,KACE,kBAACyQ,GAAA,EAAMN,IAAP,KACE,kBAACM,GAAA,EAAMa,WAAP,KAAmBxI,EAAK5C,MAAMqL,eAC9B,kBAACd,GAAA,EAAMa,WAAP,CAAkBE,UAAU,UACzB1I,EAAK2I,aAAe,kBAACC,GAAA,EAAD,CAAM/Q,KAAMmI,EAAK2I,iBAI5C,kBAAChB,GAAA,EAAMkB,KAAP,KACE,kBAAClB,GAAA,EAAMN,IAAP,KACE,kBAACM,GAAA,EAAME,KAAP,CAAYiB,QAAQ,KAClB,kBAAC3K,GAAA,EAAD,CAAOE,IAAK+H,GAAOpG,EAAK+I,MAAQ/I,EAAKM,OAAQ0I,OAAK,MAIpDhK,OAAOc,QAAQpB,GACdqF,MAAK,SAAC9O,EAAG+O,GAAJ,OAAUA,EAAE,GAAGC,cAAchP,EAAE,OACpCiP,UACAzI,KAAI,YAAsB,IAAD,mBAAnB6D,EAAmB,KAChBlC,EADgB,KAChBA,MACF3I,EAAQuL,EAAKV,GACnB,OACE,kBAAC+H,GAAD,CACEzD,IAAKtE,EACLA,QAASA,EACTiI,YAAaW,EACb9K,MAAOA,EACP3I,MAAOA,EACPyE,OAAQA,EACRuO,OAAQA,EACRD,aAAc,kBAAMpP,EAAMoP,aAAalI,Y,sTClEvD,IAAMmG,GAAatP,YAAO+D,IAAP/D,CAAH,MAIhB,SAAS8S,GAAQC,GAEf,IAUIC,EACAC,EAXEvD,EAAOhG,GAAsB,QAASqJ,GAAQ,GAFrB,GAGpB,OAAGrD,QAAH,IAAGA,KAAMhB,KAAKnG,MACC5J,sBAJK,mBAIxB4D,EAJwB,KASxBzE,GATwB,KAShBO,IAARP,MACDC,EAAG,OAAGD,QAAH,IAAGA,OAAH,EAAGA,EAAMC,IACdmV,EAA0B,MAGtB,OAAJxD,QAAI,IAAJA,OAAA,EAAAA,EAAMf,QAAS5Q,GACjBmV,EAAgB,EAChBF,EAAe,OAAGtD,QAAH,IAAGA,OAAH,EAAGA,EAAMd,WACxBqE,EAAgB,OAAGvD,QAAH,IAAGA,OAAH,EAAGA,EAAMZ,aACZ,OAAJY,QAAI,IAAJA,OAAA,EAAAA,EAAMb,QAAS9Q,IACxBmV,EAAgB,EAChBF,EAAe,OAAGtD,QAAH,IAAGA,OAAH,EAAGA,EAAMZ,WACxBmE,EAAgB,OAAGvD,QAAH,IAAGA,OAAH,EAAGA,EAAMd,YAMJuE,KAAKC,MAAsB,EAAhBD,KAAKE,UAGvCnU,qBAAU,WAAO,IAAD,EACRsJ,EAAK,OAAGkH,QAAH,IAAGA,GAAH,UAAGA,EAAMhB,YAAT,aAAG,EAAYlG,MACpBoH,EAAK,OAAGF,QAAH,IAAGA,OAAH,EAAGA,EAAME,MACpB,GAAKpH,IAASoH,EAAd,CAHc,MAqKlB,SAAcnI,GAMZ,IALA,IAAI6L,EAAQ,GAEN9K,EAAQK,OAAOC,KAAKrB,GACpB8L,EAAW/K,EAAMX,OAAS,EAEvByF,EAAI,EAAGA,EAAIiG,EAAUjG,IAAK,CAClC,IAAMkG,EAAQL,KAAKC,MAAMD,KAAKE,SAAWE,GADP,EAEnB/K,EAAMiL,OAAOD,EAAO,GAA5BpO,EAF2B,oBAGlCkO,EAAMpP,KAAKkB,GAGZ,MAAO,CAACkO,EADA9K,GA5KqBkL,CAAKlL,GAJlB,mBAIPqH,EAJO,KAIEE,EAJF,yCAsBd4D,GAtBc,4CAKd,sBAAA7U,EAAA,sEACQ9B,EAAGW,WAAW,SAASoB,IAAIgU,GAAQzJ,OAAO,CAC9C2F,WAAY,EACZF,aAAc,EACdC,aAAc,EACd,cAAgB,CACdnQ,GAAI,EACJyS,OAAQ,EAERzB,UACAE,UACA6D,UAAW,GACXzK,QAAS,KACTpG,OAAQ,QAbd,4CALc,yBAuBb,CAACgQ,EAAQrD,IAGZ,IAAIT,EAAU,OAAGS,QAAH,IAAGA,OAAH,EAAGA,EAAMT,WACjB4E,EAA2BnE,EAAOA,EAAK,IAAD,OAAKwD,EAAL,eAAkC,EAzD/C,EA2DKvU,mBAAiBkV,GA3DtB,mBA2D1BC,EA3D0B,KA2DbC,EA3Da,KA4D3BD,IAAgBD,GAClBE,EAAeF,GAGjB,IAAMG,EAAiBC,uBAAY,WACjC,IAAMC,EAAWJ,EAAY,EADU,4CAMvC,sBAAAhV,EAAA,sEACQ9B,EAAGW,WAAW,SAASoB,IAAIgU,GAAQzJ,OAAnC,0BACC4J,EADD,cAC6BgB,IAFrC,4CANuC,sBAEnCA,EAAWjF,GACb5R,QAAQC,IAAI,yBAA0B4W,EAAUjF,GAHX,mCAWvCkF,GACAJ,EAAeG,KACb,CAACJ,EAAaZ,IAEbA,GACH7V,QAAQkF,MAAM,oBAGhB,IAAM6R,EAAO1E,GA+Hf,SAAiBA,EAAgB0E,GAC/B,IAAK1E,EAAKE,OAAkB,IAATwE,EAAY,OAAO,KACtC,IAAMC,EAAO,cAAUD,GACvB,OAAOC,KAAW3E,EAAKE,MAAQF,EAAKE,MAAMyE,GAAW,KAlIhCC,CAAQ5E,EAAMoE,GAC7BS,EAAU,OAAGH,QAAH,IAAGA,OAAH,EAAGA,EAAM9C,OACnBzB,EAAUH,GAAQ8E,GAAa9E,EAAMoE,EAAa,GAClD/D,EAAUL,GAAQ8E,GAAa9E,EAAMoE,EAAa,GAClDF,EAAYlE,GAAQ8E,GAAa9E,EAAMoE,EAAa,GAE1DzW,QAAQC,IAAI,aAAcsW,GAzFK,MA4FSjV,mBAAgC,MA5FzC,mBA4FxB8V,EA5FwB,KA4FVC,EA5FU,KA8FzBC,EAAmBV,uBAAY,SAAC9K,GAChCoL,IAAerB,GACjBwB,EAAgBvL,KAEjB,CAACoL,EAAYrB,IAEV0B,EAAaX,uBAAY,WAC7B,IAAKQ,GAAmC,IAAnB5E,EAAQhI,QAAmC,IAAnBkI,EAAQlI,OACnD,OAAO,KAET,IAAI9E,EACA8R,EACAC,EACAC,EAA6B,GAE3B5L,EAAUsL,EATmB,eAUC5E,GAA7BmF,EAV4B,KAUdC,EAVc,0BAWClF,GAA7BmF,EAX4B,KAWdC,EAXc,WAY7BC,EAAUC,OAAM,OAAC3F,QAAD,IAACA,OAAD,EAACA,EAAMhB,KAAKlG,MAAMwM,GAAW7L,IAC7CmM,EAAUD,OAAM,OAAC3F,QAAD,IAACA,OAAD,EAACA,EAAMhB,KAAKlG,MAAM0M,GAAW/L,IAEnD,IAAKiM,IAAYE,EACf,OAAO,KAhB0B,4CAkCnC,gCAAAxW,EAAA,8DACqBV,GAAf0V,EADN,uBAEIzW,QAAQC,IAAI,wBAFhB,kBAGW,MAHX,cAKQ4W,EAAWJ,EAAc,EACzByB,EAAwB,IAAXxS,EAAemQ,EAAgBnQ,EANpD,SAOQ/F,EAAGW,WAAW,SAASoB,IAAIgU,GAAQzJ,QAAnC,uCACUwK,EADV,YACkC3K,GADlC,kCAEU2K,EAFV,WAEiC/Q,GAFjC,kCAGUmR,GAAa,CACzBrV,GAAIqV,EACJ5C,OAAQiE,EACR1F,QAASgF,EACT9E,QAAS+E,EACTlB,UAAWmB,EACX5L,QAAS,KACTpG,OAAQ,OAVN,2BAYQmR,GAZR,IAPR,4CAlCmC,sBAmB/BkB,EAAUE,GACZvS,EAAS,EACT8R,EAAc,uBAAOI,GAAP,CAAoBC,GAApB,aAAkCtB,GAAlC,CAA6CoB,IAC3DF,EAAc,aAAOK,IACZC,EAAUE,GACnBvS,EAAS,EACT8R,EAAc,aAAOI,GACrBH,EAAc,uBAAOK,GAAP,CAAoBH,GAApB,aAAkCpB,GAAlC,CAA6CsB,MAE3DnS,EAAS,EACT8R,EAAc,aAAOI,GACrBH,EAAc,aAAOK,GACrBJ,EAAmBnB,EAAU/L,OAAS,EAAnB,uBAA2B+L,GAA3B,CAAsCoB,EAAWE,IAAa,CAACF,EAAWE,IA/B5D,mCAwDnCf,GAEAO,EAAgB,QAEf,CAACD,EAAc/E,EAAMG,EAASE,EAAS6D,EAAWE,IAErD,IAAKpE,IAASG,IAAYE,EAAS,MAAO,CAACL,OAAM0E,OAAMN,cAAaZ,gBAAesC,SAAU,GAAIb,oBAlKlE,IAmKxBc,EAnKwB,YAmKR5F,EAnKQ,MAoKzBmF,EAAS,OAAGtF,QAAH,IAAGA,OAAH,EAAGA,EAAMhB,KAAKlG,MAAMiN,GAC5BC,EArKwB,YAqKR3F,EArKQ,MAuKzByF,EAAW,CAACR,EADH,OAAGtF,QAAH,IAAGA,OAAH,EAAGA,EAAMhB,KAAKlG,MAAMkN,IAG7BC,EAAQ,CACZC,OAAM,OAAExB,QAAF,IAAEA,OAAF,EAAEA,EAAMvV,GACdgX,OAAQnG,EAAKT,WACb6G,SAAUpG,EAAKX,aACfgH,SAAUrG,EAAKV,aACfkE,gBACAqB,aACAH,QAgBF,OAbA/W,QAAQ2Y,MAAM,CAACJ,OAAM,OAAExB,QAAF,IAAEA,OAAF,EAAEA,EAAMvV,GAC3BgX,OAAQnG,EAAKT,WACb6G,SAAUpG,EAAKX,aACfgH,SAAUrG,EAAKV,aACfkE,gBACAqB,eAEFlX,QAAQ2Y,MAAR,OAActG,QAAd,IAAcA,OAAd,EAAcA,EAAME,OAEpBvS,QAAQC,IAAIqY,GAEZtY,QAAQC,IAAKmX,KAAgB,OAACL,QAAD,IAACA,OAAD,EAACA,EAAMrR,QAAS0R,IAAc,OAACL,QAAD,IAACA,OAAD,EAACA,EAAMrR,SAE3D,CAAC2M,OAAMnN,QAAO6R,OAAMN,cAAaS,aAAYrB,gBAAeF,kBAAiBC,mBAAkBuC,WAAUf,eAAcE,mBAAkBC,aAAYZ,iBAAgB2B,SAwB9K,SAASnB,GAAa9E,EAAgB0E,EAAc6B,GAClD,OAAKvG,EAAKE,OAAkB,IAATwE,EACD,IAAd6B,EAAwBvG,EAAKE,MAAL,cAAkBwE,IAAlB,WAC5B/W,QAAQC,IAAI,YAAa8W,GAClB1E,EAAKE,MAAL,cAAkBwE,IAAlB,WAA8B6B,EAA9B,WAH+B,GAmJxC,IAAMC,GAAgBlW,IAAOK,IAAV,MACR,SAAA4B,GAAK,MAAoB,UAAhBA,EAAMkU,MAAoB,QAAU,UAIrC,SAAAlU,GAAK,MAAoB,UAAhBA,EAAMkU,MAAoB,qBAAuB,wBAC7D,SAAAlU,GAAK,MAAoB,UAAhBA,EAAMkU,MAAoB,UAAY,WAEpD,SAAAlU,GAAK,OAAIA,EAAMwC,SAG1B,SAAS2R,GAAT,GAAyI,IAAvHpY,EAAsH,EAAtHA,SAAUU,EAA4G,EAA5GA,SAA4G,IAAlGyX,aAAkG,MAA1F,OAA0F,EAAlF1R,EAAkF,EAAlFA,MACpD,OACE,kBAACyR,GAAD,CAAeC,MAAOA,EAAO1R,MAAOA,GAClC,2BAAIzG,EAAJ,KAAkB,6BAClB,0BAAMqO,MAAO,CAAC5H,MAAO,UAAW/F,IAKvB2X,OAjKf,WAAqB,IAYfC,EACAC,EACAC,EAdc,EAKkK1D,GAHnKrJ,cAAVsJ,QAGArD,EALW,EAKXA,KAAa0E,GALF,EAKL7R,MALK,EAKE6R,MAAMN,EALR,EAKQA,YAAaS,EALrB,EAKqBA,WAAYrB,EALjC,EAKiCA,cAAeF,EALhD,EAKgDA,gBAAiBC,EALjE,EAKiEA,iBAAkBuC,EALnF,EAKmFA,SAAUf,EAL7F,EAK6FA,aAAcE,EAL3G,EAK2GA,iBAAkBC,EAL7H,EAK6HA,WAAYZ,EALzI,EAKyIA,eALzI,KAKyJ2B,MALzJ,YAMaH,EANb,IAMXR,EANW,KAMAE,EANA,KAQZuB,EAAgC,IAAlBvD,EAAsB8B,EAAYE,EAChDwB,EAAiC,IAAlBxD,EAAsBgC,EAAYF,EACjD7L,EAAO,OAAGiL,QAAH,IAAGA,OAAH,EAAGA,EAAMjL,SAMd,OAAJiL,QAAI,IAAJA,OAAA,EAAAA,EAAMrR,UAAWmQ,GACnBoD,EAAY,4BACZC,EAAe,eACfC,EAAgB,gBACU,KAAb,OAAJpC,QAAI,IAAJA,OAAA,EAAAA,EAAMrR,SACfuT,EAAY,mCACZC,EAAe,eACfC,EAAgB,iBACX,OAAIpC,QAAJ,IAAIA,OAAJ,EAAIA,EAAMrR,UACfuT,EAAY,6BACZC,EAAe,eACfC,EAAgB,gBAGlB,IAAMG,EAA4B,IAAlBzD,EAAsB,MAAQ,OACxC0D,EAA4B,IAAlB1D,EAAsB,OAAS,MAE/C,OAAKxD,EAQA+G,GAAgBC,EAOPA,EAOFD,EASV,kBAACnT,EAAA,EAAD,KACA,kBAAC1C,EAASmB,OAAV,iBACCmR,IAAkBqB,EACjB,kBAAC6B,GAAD,CAASpY,SAAS,eAAeyG,MAAM,SAAvC,SAAsDqP,EAAtD,eAA+Ed,EAA/E,oBAEA,kBAACoD,GAAD,CAASpY,SAAS,eAAeyG,MAAM,SAAvC,SAAsDqP,EAAtD,KAAqEb,EAArE,YAED9J,GACC,oCACG+J,IAAkBqB,EACjB,oCACE,kBAAC6B,GAAD,CAASpY,SAAUgV,EAAiBmD,MAAM,QAAQ1R,MAAM,kBAAkBiL,EAAKhB,KAAKnG,MAAMY,GAASlC,MAAnG,KAA4GwP,EAAYtN,IACxH,kBAACiN,GAAD,CAASpY,SAAUiV,EAAkBxO,MAAM,UAAUiL,EAAKhB,KAAKnG,MAAMY,GAASlC,MAA9E,KAAuFyP,EAAavN,GAApG,IAA+GqN,IAGjH,oCACE,kBAACJ,GAAD,CAASpY,SAAUiV,EAAkBxO,MAAM,UAAUiL,EAAKhB,KAAKnG,MAAMY,GAASlC,MAA9E,KAAuFyP,EAAavN,IACpG,kBAACiN,GAAD,CAASpY,SAAUgV,EAAiBmD,MAAM,QAAQ1R,MAAM,kBAAkBiL,EAAKhB,KAAKnG,MAAMY,GAASlC,MAAnG,KAA4GwP,EAAYtN,GAAxH,IAAmIoN,KAK1ID,GACC,kBAACF,GAAD,CAASpY,SAAS,eAAeyG,MAAM,SAAS6R,GAEhDG,GACA,kBAAC,GAAD,CACE5M,KAAM4M,EACNlO,MAAOmH,EAAKhB,KAAKnG,MACjBwJ,iBAAqB,OAAJqC,QAAI,IAAJA,OAAA,EAAAA,EAAMjL,UAAWsL,EAClCnD,OAAQ4B,EACRnQ,QAAY,OAAJqR,QAAI,IAAJA,OAAA,EAAAA,EAAMrR,SAAUqR,EAAKrR,OAC7BsO,aAAcsD,EACd5J,SAA2B,OAAZ,OAAJqJ,QAAI,IAAJA,OAAA,EAAAA,EAAMrR,SAAkBwR,IAAerB,IAMrD,kBAACvS,EAAD,KACoB,MAAhB8T,GAA0C,OAAb,OAAJL,QAAI,IAAJA,OAAA,EAAAA,EAAMjL,UAAmC,OAAZ,OAAJiL,QAAI,IAAJA,OAAA,EAAAA,EAAMrR,SACzD,oCACA,kBAACgB,EAAA,EAAD,CACEU,MAAOkS,EACPE,QAAS7D,EACThD,KAAK,OACL8G,MAAO,CAAEC,OAAO,EAAMtS,MAAOkS,EAASK,SAAU,OAAQH,QAAO,OAAEzC,QAAF,IAAEA,OAAF,EAAEA,EAAMvE,QAAQhI,UAEjF,6BAAK,6BACL,kBAAC9D,EAAA,EAAD,CACEU,MAAOmS,EACPC,QAAS5D,EACTjD,KAAK,OACL8G,MAAO,CACLC,OAAO,EACPtS,MAAOmS,EACPI,SAAU,OACVH,QAAO,OAAEzC,QAAF,IAAEA,OAAF,EAAEA,EAAMrE,QAAQlI,WAK3B4M,GAAgBX,IAAgBpE,EAAKT,YAAciE,IAAkBqB,GACrE,kBAAC,GAAD,CAAYnF,UAAQ,EAAC3K,MAAM,MAAMuL,KAAK,OAAOrO,KAAK,OAAOJ,QAASqT,GAAlE,aAIAd,EAAcpE,EAAKT,YAA8B,OAAZ,OAAJmF,QAAI,IAAJA,OAAA,EAAAA,EAAMrR,SACvC,kBAAC,GAAD,CAAYqM,UAAQ,EAAC3K,MAAM,MAAMuL,KAAK,eAAerO,KAAK,OAAOJ,QAASyS,GAA1E,gBA3EF,oCACE,kBAACpT,EAASmB,OAAV,mBACA,kBAACqU,GAAD,CAASpY,SAAS,eAAeyG,MAAM,SAAvC,cAA2DwO,EAA3D,wBATF,oCACE,kBAACrS,EAASmB,OAAV,mBACA,kBAACqU,GAAD,CAASpY,SAAS,eAAeyG,MAAM,SAAvC,cAA2DuO,EAA3D,wBATF,oCACE,kBAACpS,EAASmB,OAAV,mBACA,kBAACqU,GAAD,CAASpY,SAAS,eAAeyG,MAAM,SAAvC,2DAXJ,kBAAC,GAAD,OCzOWwS,OApCf,WAEE,OACE,kBAAC3T,EAAA,EAAD,KACE,kBAAC1C,EAASmB,OAAV,2BACA,iDACA,wDAEA,iHAAsF,uBAAGmV,KAAK,8BAAR,OACtF,iEACA,0CACA,4BACE,mDACA,0EACA,4DACA,sDAEF,iEACA,0CACA,4BACE,8CACA,qEAEF,4CACA,4BACE,8GACA,gDAEF,qCACA,4BACE,8D,yGCPR,IAAM5H,GAAatP,YAAO+D,IAAP/D,CAAH,MAIhB,SAASmX,KACP,IAOMnW,EAAUC,cACRnD,EAASO,IAATP,KAGR,OAFAT,QAAQC,IAAI,eAAgBQ,GAG1B,kBAACwF,EAAA,EAAD,KAEG,sCAAYxF,EAAKE,UAClB,kBAAC,GAAD,CACIC,KAAI,OAAEH,QAAF,IAAEA,OAAF,EAAEA,EAAMG,KACZ2I,QAAQ,kBACRC,IAAK,kBACH,kBAAC/E,GAAD,CAAiBhC,GAAG,WAApB,aAMN,kBAAC,GAAD,CAAMmH,MAAM,aAAaQ,MAzBX,CAChB,CAACR,MAAO,QAAS9D,IAAK,SAAUmD,OAAO,eACvC,CAACW,MAAO,QAAS9D,IAAK,cAAemD,OAAO,eAC5C,CAACW,MAAO,UAAW9D,IAAK,WAAYmD,OAAO,iBAC3C,CAACW,MAAO,QAAS9D,IAAK,SAAUmD,OAAO,eACvC,CAACW,MAAO,aAAc9D,IAAK,cAAemD,OAAO,qBAoBJxI,KAAMA,IAElC,YAAdA,EAAKG,MAAsB,kBAACmZ,GAAD,MAE5B,kBAAC,GAAD,CACInZ,KAAI,OAAEH,QAAF,IAAEA,OAAF,EAAEA,EAAMG,KACZ2I,QAAQ,cACRC,IAAK,kBACH,kBAAClG,EAAD,KACE,kBAAC,GAAD,CACE8D,MAAM,MACNuL,KAAK,MACLrO,KAAK,OACLyN,UAAQ,EACR7N,QAAS,kBAAMP,EAAQkD,KAAR,gBALjB,iBA8CCmT,OA1Bf,WACE,OACE,kBAAC,IAAD,KAGE,kBAAC,IAAD,CAAO3Z,KAAK,UAAUgC,UAAWwC,KACjC,kBAAC,IAAD,CAAOxE,KAAK,UAAUgC,UAAWuE,KACjC,kBAAC,IAAD,CAAOvG,KAAK,QAAQgC,UAAWyX,KAC/B,kBAAC,IAAD,CAAOzZ,KAAK,SAASgC,UAAWuX,KAChC,kBAAC,IAAD,CAAOvZ,KAAK,cAAcgC,UAAW2P,KAGrC,kBAAC,EAAD,CAAW3R,KAAK,WAAWgC,UAAWoI,KACtC,kBAAC,EAAD,CAAWpK,KAAK,cAAcgC,UAAWiJ,KACzC,kBAAC,EAAD,CAAWjL,KAAK,aAAagC,UAAWuO,KACxC,kBAAC,EAAD,CAAWvQ,KAAK,SAASgC,UAAW4X,KACpC,kBAAC,EAAD,CAAW5Z,KAAK,gBAAgBgC,UAAW2W,KAC3C,kBAAC,EAAD,CAAW3Y,KAAK,8BAA8BgC,UAAW8J,KACzD,kBAAC,EAAD,CAAW9L,KAAK,8BAA8BgC,UAAWqN,KACzD,kBAAC,EAAD,CAAWrP,KAAK,WAAWgC,UAAW0X,KAEtC,kBAAC,IAAD,CAAUG,KAAK,IAAIzX,GAAG,YClFb0X,OAff,WAEE,OACE,kBAAC,IAAD,KAEE,kBAAC,EAAD,KACE,kBAAC,GAAD,KACE,kBAAC,GAAD,UCLUC,QACW,cAA7BC,OAAOxW,SAASyW,UAEe,UAA7BD,OAAOxW,SAASyW,UAEhBD,OAAOxW,SAASyW,SAASC,MACvB,2DCXNC,IAASjY,OACP,kBAAC,IAAMkY,WAAP,KACE,kBAAC,GAAD,OAEFC,SAASC,eAAe,SDgIpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrB7M,MAAK,SAAA8M,GACJA,EAAaC,gBAEdC,OAAM,SAAA/V,GACLlF,QAAQkF,MAAMA,EAAMc,c","file":"static/js/main.3753279b.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/ant.2fe8faf8.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/ben.6cba428d.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/dan.abf052b9.jpeg\";","module.exports = \"data:image/jpeg;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/didun.2cfccad8.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/grant.39b9be86.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/mike.006e457e.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/morgan.9c9ff2b1.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/nick.c153051e.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/pearce.2064c0f2.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/rob.5110024b.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/scouse.d02204f4.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/stevooo.965acec9.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/sunny.c00e8603.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/will.32aef3bd.jpeg\";","module.exports = __webpack_public_path__ + \"static/media/vinnie.bb7ff1a7.jpeg\";","import * as firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nimport \"firebase/auth\";\nimport \"firebase/storage\";\n\n// @todo move to .env file\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDPk2j-y4TB9ex6MWD0jZmHXsN2aw6VZv4\",\n  authDomain: \"trumps-53976.firebaseapp.com\",\n  databaseURL: \"https://trumps-53976.firebaseio.com\",\n  projectId: \"trumps-53976\",\n  storageBucket: \"trumps-53976.appspot.com\",\n  messagingSenderId: \"822188667084\",\n  appId: \"1:822188667084:web:56d4680cf508a02ea55269\",\n  measurementId: \"G-FNX5HRRFLY\"\n};\n\nfirebase.initializeApp(firebaseConfig);\n\nexport const auth = firebase.auth();\nexport const db = firebase.firestore();\nexport const storage = firebase.storage()\n\nexport const authenticateAnonymously = () => {\n  return auth.signInAnonymously();\n};\n\nexport const signInWithFacebook= () => {\n  const facebookAuth = new firebase.auth.FacebookAuthProvider();\n  console.log('FB LOGIN')\n  return firebase.auth().signInWithPopup(facebookAuth);\n    // .then(res => console.log('FB RES', res))\n    // .catch(e => console.error('FB ERROR', e));\n};\n\nexport function signUp(email, password) {\n  return auth.createUserWithEmailAndPassword(email, password);\n}\n\nexport function signIn(email, password) {\n  return auth.signInWithEmailAndPassword(email, password);\n}\n\nexport function signOut() {\n  return auth.signOut();\n}\n\nexport function onAuthStateChanged(user) {\n  return auth.onAuthStateChanged(user);\n}\n\nexport function getCollection(path) {\n  return db.collection(path);\n};\n\nexport function getUsers() {\n  return db.collection('users');\n};\n\nexport const getCard = id => {\n  return db\n    .collection('variant').doc('pioneers')\n    .collection('categories').doc('classic')\n    .collection('cards').doc('morgan')\n    .get();\n};\n\n// export const getCard = id => {\n//   return db.collection('cards')\n//       .doc(id)\n//       .get();\n// };","// import React, { createContext, useState, useEffect, useMemo, useContext } from \"react\";\n\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport {db, getCollection} from '../services/firestore';\nimport { onAuthStateChanged } from '../services/firestore';\n\n// export type UserType = firebase.User;\n\n// type AuthType = {\n// currentUser?: UserType;\n// role: 'visitor' | 'user' | 'moderator' | 'creator' | 'admin' | 'superadmin' | 'dev'\n// }\nexport type UserType = {\n  uid: string | null;\n  username: string | null;\n  role: 'visitor' | 'user' | 'moderator' | 'creator' | 'admin' | 'superadmin' | 'dev'\n  groups?: string[];\n}\n\ntype AuthType = {\n  authenticated: boolean;\n  user: UserType;\n}\n\nconst defaultAuth: AuthType = {\n  authenticated: false,\n  user: {\n    uid: null,\n    username: 'Visitor',\n    role: 'visitor',\n  }\n}\n\nexport const AuthContext = createContext<AuthType | undefined>(undefined);\n\nconsole.log('AUTH CONTEXT VALUE', AuthContext);\n\nfunction AuthProvider({ children }: any) {\n\n  const [auth, setAuth] = useState<AuthType>(defaultAuth);\n\n  async function fetchUser(id: string) {\n    const doc = await getCollection('users').doc(id).get();         \n    const user = doc.data() as UserType;\n    console.log('FETCH USER', user);\n    setAuth({\n      authenticated: true,\n      user,\n    });\n  }\n\n  useEffect(() => {\n    const unsubsribe = onAuthStateChanged((user: firebase.User) => {\n      const auth: AuthType = {\n        authenticated: true,\n        user: {\n          uid: user?.uid,\n          username: user?.displayName,\n          role: 'user',\n          // group: 'pioneers'\n        }\n      }\n      console.log('AUTH', auth);\n      console.log('USER', user);\n      if (user) {\n\n        fetchUser(user.uid);\n\n        setAuth(auth);\n      } else {\n        setAuth(defaultAuth);\n      }\n    });\n    return () => {\n      setAuth(defaultAuth);\n      unsubsribe();\n    }\n  }, []);\n\n  return (\n    <AuthContext.Provider value={auth}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport function useAuthContext() {\n  const value = useContext(AuthContext);\n  console.log('USE AUTH CONTEXT VALUE', value);\n  if (value === undefined) {\n    throw new Error('Expected context value to be set');\n  }\n  return value;\n}\n\nexport default AuthProvider;","import React from 'react';\nimport { Route, Redirect, RouteProps } from \"react-router-dom\";\nimport { useAuthContext } from './AuthProvider';\n\ntype PropType = RouteProps & {\n  component: any;\n}\n\nfunction AuthRoute({ component: Component, ...rest }: PropType) {\n  const {authenticated} = useAuthContext();\n  console.log('AUTH_ROUTE AUTHENTICATED', authenticated);\n  return (\n    <Route \n      {...rest} \n      render={(routeProps) => (\n        !!authenticated ? (\n          <Component {...routeProps} />\n        ) : (\n          <Redirect to='/signin' />\n        )  \n    )} />\n  );  \n}\n\nexport default AuthRoute;","import React, { ReactChild } from 'react';\nimport { createTeleporter } from 'react-teleporter';\nimport styled from \"styled-components\";\nimport { useAuthContext } from '../components/AuthProvider';\nimport { Container, Icon } from 'semantic-ui-react';\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport { Link } from \"react-router-dom\";\n\nconst HeaderContainer = styled.header`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: fixed;\n  height: 50px;\n  background: #1b9a59;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 1;\n`;\n\nconst H1 = styled.h1`\n  color: white;\n  margin: 0;\n`;\n\nconst HeaderLeft = styled.div`\n  position: fixed;\n  left: 0;\n  margin-left: 5px;\n`;\n\nconst HeaderRight = styled.div`\n  position: fixed;\n  right: 0;\n  margin-right: 10px;\n`;\n\nconst HeaderLink = styled(Link)`\n  color: white;\n  &:hover {color: white;}\n`;\n\nconst MainContainer = styled.div`\n  background: WhiteSmoke;\n  min-height: 100vh;\n  max-height: 100%;\n`;\n\nconst ContentContainer = styled.div`\n  padding-top: 60px;\n`;\n\nexport const Footer = styled.div`\n  position: fixed;\n  height: 50;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  padding: 10px;\n`;\n\ntype PropsType = {\n  children: ReactChild;\n}\n\ntype LocationType = {\n  pathname: string;\n}\n\ntype LinkPropsType = {\n  to: string; \n  children: ReactChild\n}\n\nexport const TitleBar = createTeleporter();\nexport const HeaderRightButton = createTeleporter();\n\nfunction Layout(props: PropsType) {\n  const {children} = props;\n\n  return (\n    <MainContainer>\n      <Header/>\n      <ContentContainer>\n        {children}\n      </ContentContainer>\n    </MainContainer>\n  )\n}\n\nfunction Header() {\n  const history = useHistory();\n  const location = useLocation<LocationType>();\n  console.log('LOCATION', location);\n  const showBackButton = !['/home', '/signin', '/singout'].includes(location.pathname);\n  return (\n    <HeaderContainer>\n      {showBackButton && <HeaderLeft onClick={() => history.goBack()}><Icon name='angle left' size='large' inverted/></HeaderLeft>}\n      <H1><TitleBar.Target /></H1>\n      <HeaderRight><HeaderRightButton.Target /></HeaderRight>\n    </HeaderContainer>\n  )\n}\n\nexport function HeaderRightLink({to, children}: LinkPropsType) {\n  return (\n    <HeaderRightButton.Source>\n      <HeaderLink to={to}>{children}</HeaderLink>\n    </HeaderRightButton.Source>\n  );\n}\n\nexport default Layout;","import React, { useState } from 'react';\nimport { Form, Button, Container } from 'semantic-ui-react';\nimport { db, signUp, signOut } from '../services/firestore';\nimport {TitleBar} from '../components/Layout';\n\nconst SignUp = () => {\n  // User State\n  const [user, setUser] = useState({\n    firstname: '',\n    lastname: '',\n    username: '',\n    email: '',\n    password: '',\n    error: '',\n  });\n\n  console.log('SIGN UP');\n\n  // onChange function\n  // const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n  const handleChange = (e: any) => {\n    setUser({\n      ...user,\n      [e.target.name]: e.target.value,\n      error: '',\n    })\n  };\n\n  // Submit function (Create account)\n  const handleSubmit = async (e: any) => {\n    e.preventDefault();\n    try {\n      const result = await signUp(user.email, user.password);\n      if (result?.user) {\n        console.log('USER', user);\n        await result.user.updateProfile({\n          displayName: user.username,\n        })\n\n        await db.collection('users').doc(result.user.uid).set({\n          uid: result.user.uid,\n          firstname: user.firstname,\n          lastname: user.lastname,\n          username: user.username,\n          email: user.email,\n          role: 'user',\n        });\n\n        // URL of my website.\n        const myURL = { url: 'https://rinse0ut.github.io/trumps/' }\n\n        // Send Email Verification and redirect to my website.\n        await result.user.sendEmailVerification(myURL);\n\n        setUser({\n          ...user,\n          error: `Welcome ${user.username}. To continue please verify your email.`,\n        })\n\n        // Sign Out the user.\n        signOut();\n\n      }\n    } catch (e) {\n      setUser({\n        ...user,\n        error: e.message\n      })\n    }\n  }\n\n  return (\n    <Container>\n      <TitleBar.Source>Sign Up</TitleBar.Source>\n      <br></br>\n      <Form onSubmit={handleSubmit}>\n        <Form.Field>\n          <label htmlFor=\"firstname\">First Name</label>\n          <input type=\"text\" placeholder=\"First Name\" name=\"firstname\" onChange={handleChange} required /><br />\n        </Form.Field>\n        <Form.Field>\n          <label htmlFor=\"username\">Last Name</label>\n          <input type=\"text\" placeholder=\"Last Name\" name=\"lastname\" onChange={handleChange} required /><br />\n        </Form.Field>                \n        <Form.Field>\n          <label htmlFor=\"username\">Username</label>\n          <input type=\"text\" placeholder=\"Username\" name=\"username\" onChange={handleChange} required /><br />\n        </Form.Field>        \n        <Form.Field>\n          <label htmlFor=\"email\">Email</label>\n          <input type=\"text\" placeholder=\"Email\" name=\"email\" onChange={handleChange} required /><br />\n        </Form.Field>\n        <Form.Field>\n          <label htmlFor=\"password\">Password</label>\n          <input type=\"password\" placeholder=\"Password\" name=\"password\" onChange={handleChange} required /><br />\n        </Form.Field>\n      <Button primary type=\"submit\">Sign Up</Button>\n    </Form>\n      { user.error && <h4>{user.error}</h4> }\n    </Container>\n  )\n};\n\nexport default SignUp;","import React, { useState } from 'react';\nimport { db, getCollection, signIn, signOut, signInWithFacebook } from '../services/firestore';\nimport styled from \"styled-components\";\nimport { useAuthContext } from '../components/AuthProvider';\nimport { useHistory } from \"react-router-dom\";\nimport { Form, Button, Icon, Container, Segment } from 'semantic-ui-react'\nimport { TitleBar, HeaderRightLink } from '../components/Layout';\n\nconst ContainerLogin = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100vh;  \n  width: 100vw;  \n  margin-top: -60px;\n`\n\nfunction SignIn() {\n\n  const { authenticated } = useAuthContext();\n\n  const history = useHistory();\n\n  if (authenticated) {\n    history.push(\"/home\");\n  }\n\n  const [user, setUser] = useState({\n    email: '',\n    password: '',\n    error: '',\n  });\n\n  const handleChange = (e: any) => {\n    setUser({\n      ...user,\n      [e.target.name]: e.target.value,\n      error: '',\n    })\n  };\n\n  // Submit function (Log in user)\n  const handleSubmit = async (e: any) => {\n    e.preventDefault();\n    try {\n      const result = await signIn(user.email, user.password);\n      if (!result?.user?.emailVerified) {\n        setUser({\n          ...user,\n          error: 'Please verify your email before to continue',\n        });\n        await signOut();\n      }\n      history.push(\"/home\");\n    } catch (e) {\n      setUser({\n        ...user,\n        error: e.message,\n      })\n    }\n  }\n\n  const handleFacebookSignIn = async (e: any) => {\n    try {\n      const result = await signInWithFacebook();\n      if (!result) {\n        setUser({...user, error:'Facebook user not found'});\n        return;\n      }\n      result && console.log('FB', result);\n      if (result && result?.additionalUserInfo) {\n        const doc = await getCollection('users').doc(result?.user?.uid).get();         \n        console.log('HAS USER', doc.exists);\n        !doc.exists && await db.collection('users').doc(result?.user?.uid).set({\n          // profile: result?.additionalUserInfo?.profile,\n          uid: result?.user?.uid,\n          username: result?.user?.displayName,\n          email: result?.user?.email,\n          photoURL: result?.user?.photoURL,\n          role: 'user',\n        });\n      }  \n      history.push(\"/home\");\n    } catch (e) {\n      setUser({\n        ...user,\n        error: e.message,\n      })\n    }\n  }\n\n  return (\n      <Container>\n        <TitleBar.Source>Top Trumps</TitleBar.Source>\n        <HeaderRightLink to=\"/signup\">SIGN UP</HeaderRightLink>\n        <br></br>\n        <Form onSubmit={handleSubmit}>\n          <Form.Field>\n            <label htmlFor=\"email\">Email</label>\n            <input type=\"text\" placeholder=\"Email\" name=\"email\" onChange={handleChange} required /><br />\n          </Form.Field>\n          <Form.Field>\n            <label htmlFor=\"password\">Password</label>\n            <input type=\"password\" placeholder=\"Password\" name=\"password\" onChange={handleChange} required /><br />\n          </Form.Field>\n          <Button primary type=\"submit\">Sign in</Button>\n          {/* <Button>\n            <Link to=\"/signup\">Sign up</Link>\n          </Button> */}\n        </Form>\n        <br/><hr/><br/>\n        <Button color=\"facebook\" onClick={handleFacebookSignIn} >\n          <Icon name='facebook' />\n          Sign in with Facebook\n       </Button>\n        {user.error && <Segment color=\"red\">{user.error}</Segment>}\n      </Container>\n  )\n};\n\nexport default SignIn;","import React from 'react';\nimport { Button } from 'semantic-ui-react';\nimport { signOut } from '../services/firestore';\n\nconst Logout = () => {\n\n  // Log out function\n  const handleClick = async () => {\n    await signOut();\n  }\n\n  return (\n    <Button type=\"button\" onClick={handleClick}>Log Out</Button>\n  )\n};\n\nexport default Logout;","import { useEffect, useState } from \"react\";\nimport {db, getCollection} from '../services/firestore';\n\ntype item = {\n  id: string;\n  title?: string;\n  email?: string;\n\n}\n\nfunction useCollection<T>(path: string, isSnapshot: boolean = false) {\n  const [data, setData] = useState<T[]>();\n\n  useEffect(() => {\n    if (!path) return;\n \n    if (isSnapshot) {\n      return db.collection(path).onSnapshot(snapshot => {\n        const data: T[] = [];\n        const docs = snapshot.docs;\n        for (let doc of docs) {\n          console.log(`Document found at path: ${doc.ref.path}`);\n          const {id} = doc;\n          const item = doc.data() as T;\n          data.push({id, ...item})\n        }\n        setData(data);\n      });\n    }    \n\n    async function fetchData() {\n      const snapshot = await getCollection(path).get();         \n      const data = snapshot.docs.map(doc => {\n        console.log('DOC', doc.id, doc.data());\n        const {id} = doc;\n        const data = doc.data();\n        return {id, ...data}\n      });\n      console.log('DATA', data);\n      // @ts-ignore\n      setData(data);\n    }\n\n    fetchData();\n  }, [])\n\n  return data;\n}\n\nexport default useCollection;","import React from \"react\";\nimport { Container, Icon } from 'semantic-ui-react';\nimport styled from \"styled-components\";\n\nconst LoadingContainer = styled.div`\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-top: -70px;\n`;\n\nfunction Loading() {\n  return (\n    <LoadingContainer>\n      <Icon loading name='spinner' size='big' />\n    </LoadingContainer>\n  )\n}\n\nexport default Loading;","// type RuleType = {\n//   static: string[],\n//   dynamic: {},\n// }\n\nexport type RulesType = {\n  [id: string]: any, // @TODO\n};\n\nconst rules: RulesType = {\n  visitor: {\n    static: [\n      \"about:visit\",\n      \"membership:visit\",\n      \"home-page:login\",\n    ]  \n  },\n  user: {\n    static: [\n      \"about:visit\",\n      \"membership:visit\",\n      \"games:visit\",\n      \"friends:visit\",\n    ],\n    dynamic: {\n      \"game:play\": ({packGroupId, userGroupIds}:{packGroupId:string, userGroupIds:string[]}) => {\n        console.log('GAME:PLAY', {userGroupIds, packGroupId});\n        if (packGroupId === 'public') return true;\n        if (!userGroupIds) return false;\n        console.log('GAME:PLAY INCLUDES', userGroupIds.includes(packGroupId));\n        return userGroupIds.includes(packGroupId);\n      },\n    }\n  },\n  moderator: {\n    static: [\n      \"about:visit\",\n      \"membership:visit\",      \n      \"games:visit\",\n      \"friends:visit\",      \n      \"fiends:visit\",      \n      \"packs:visit\",\n      \"packs:edit\",\n    ],\n  },  \n  creator: {\n    static: [\n      \"about:visit\",\n      \"membership:visit\",      \n      \"games:visit\",\n      \"fiends:visit\",\n      \"packs:visit\",\n      \"packs:edit\",\n      \"packs:delete\",\n      \"packs:create\",  \n    ],\n    dynamic: {\n      \"pack:edit\": ({userId, packOwnerId}:{userId:string, packOwnerId:string}) => {\n        if (!userId || !packOwnerId) return false;\n        return userId === packOwnerId;\n      }\n    }\n  },    \n  admin: {\n    static: [\n      \"about:visit\",\n      \"membership:visit\",      \n      \"games:visit\",\n      \"friends:visit\",\n      \"packs:visit\",\n      \"packs:edit\",\n      \"packs:delete\",\n      \"packs:create\",      \n      // \"users:get\",\n      // \"users:getSelf\",\n      // \"home-page:visit\",\n      // \"dashboard-page:visit\"\n    ]\n  }\n};\n\nexport default rules;","import rules, {RulesType} from \"./rules\";\n\nfunction check (rules: RulesType, role: string, action: string, data: string) {\n  const permissions = rules[role];\n  if (!permissions) {\n    // role is not present in the rules\n    return false;\n  }\n\n  const staticPermissions = permissions.static;\n\n  if (staticPermissions && staticPermissions.includes(action)) {\n    // static rule not provided for action\n    return true;\n  }\n\n  const dynamicPermissions = permissions.dynamic;\n\n  if (dynamicPermissions) {\n    const permissionCondition = dynamicPermissions[action];\n    if (!permissionCondition) {\n      // dynamic rule not provided for action\n      return false;\n    }\n\n    return permissionCondition(data);\n  }\n  return false;\n};\n\nfunction Can(props: any) { // @TODO\n  return check(rules, props.role, props.perform, props.data)\n    ? props.yes()\n    : props.no();\n}\n\nCan.defaultProps = {\n  yes: () => null,\n  no: () => null\n};\n\nexport default Can;","import React from 'react'\nimport { List, Segment } from 'semantic-ui-react';\nimport { Link } from \"react-router-dom\";\nimport Loading from '../components/Loading';\nimport { TitleBar } from '../components/Layout';\nimport {UserType} from '../components/AuthProvider';\nimport Can from '../auth/Can';\n\ntype PropsType = {\n  title: string;\n  items?: any[];  // @TODO type\n  user?: UserType;\n  renderItem?: (item: any) => JSX.Element;\n}\n\nfunction ListComponent({ user, title, items, renderItem }: PropsType) {\n\n  if (!items) {\n    return (\n      <Loading />\n    )\n  }\n\n  function maybe(item:any) {\n    if (user && item.action) {\n      return (\n        <Can\n          role={user?.role}\n          perform={item.action}\n          yes={() => renderItem ? renderItem(item) : <DefaultListItem {...item}/>}\n        />\n      );\n    }\n    return renderItem ? renderItem(item) : <DefaultListItem {...item}/> \n  }\n\n  return (\n    <>\n      <TitleBar.Source>{title}</TitleBar.Source>\n      <Segment>\n        <List divided relaxed=\"very\" size=\"large\">\n          {items.length > 0\n            ? items.map(maybe)\n            : <ListItem>No items</ListItem>\n          }\n        </List>\n      </Segment>\n    </>\n  )\n}\n\ntype ListItemPropsType = {\n  title?: string;\n  description?: string;\n  url?: string;\n}\n\nfunction DefaultListItem({ title, description, url }: ListItemPropsType) {\n  return (\n    <List.Item>\n      <List.Content>\n        <List.Header>\n          {url ? <Link to={url}>{title}</Link> : title}\n        </List.Header>\n        {description}\n      </List.Content>\n    </List.Item>\n  )\n}\n\nexport function ListItem({ children }: any) {\n  return (\n    <List.Item>\n      <List.Content>\n        {children}\n      </List.Content>\n    </List.Item>\n  )\n}\n\nexport function ListHeader({ children }: any) {\n  return (\n    <List.Header>\n      {children}\n    </List.Header>\n  )\n}\n\nexport default ListComponent","import React from \"react\";\nimport { Image } from 'semantic-ui-react'\nimport useCollection from '../hooks/useCollection';\nimport FriendList from '../components/List';\nimport { List } from 'semantic-ui-react';;\n\nfunction FriendsPage() {\n\n  const users = useCollection<any>('users');\n\n  return (\n    <FriendList\n      title=\"Friends 🌎\"\n      items={users}\n      renderItem={(item: any) => (\n        <List.Item>        \n          <Image avatar src={item.photoURL} />\n          <List.Content>\n            <List.Header>\n              {item.username}\n            </List.Header>\n            {/* {item.status ? item.status : 'Pioneer'}  */}\n            {/* {item.firstname} {item.lastname}<br/> */}\n            {/* {item.email}  */}\n          </List.Content>\n        </List.Item>        \n    )} />\n  )\n}\n\nexport default FriendsPage;","import React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport {db} from '../services/firestore';\nimport {CategoryType, CardsType} from '../types';\nimport useCollection from '../hooks/useCollection';\nimport List, {ListHeader, ListItem} from '../components/List';\nimport { Form, Button, Container } from 'semantic-ui-react'\nimport { useAuthContext } from '../components/AuthProvider';\n\n// const CARDS: CardsType = {\n//   \"ant\": {\n//     title: 'Ant',\n//     img: 'ant',\n//     countryCode: 'uk',\n//   },\n//   ben: {\n//     title: 'American Ben',\n//     img: 'ben',\n//     countryCode: 'us',\n//   },\n//   dan: {\n//     title: 'Karate Dan',\n//     img: 'dan',\n//     countryCode: 'gb sct',\n//   },\n//   didun: {\n//     title: 'Dids',\n//     img: 'didun',\n//     countryCode: 'gb wls',\n//   },\n//   dt: {\n//     title: 'DT',\n//     img: 'dt',\n//     countryCode: 'uk',\n//   },\n//   grant: {\n//     title: 'G Dawg',\n//     img: 'grant',\n//     countryCode: 'gb wls',\n//   },\n//   mike: {\n//     title: 'Mike',\n//     img: 'mike',\n//     countryCode: 'fr',\n//   },\n//   morgan: {\n//     title: 'Captain Morgan',\n//     img: 'morgan',\n//     countryCode: 'gb sct',\n//   },\n//   nick: {\n//     title: 'Nick',\n//     img: 'nick',\n//     countryCode: 'uk',\n//   },  \n//   pearce: {\n//     title: 'Pearce',\n//     img: 'pearce',\n//     countryCode: 'gb sct',\n//   },\n//   rob: {\n//     title: 'Landers',\n//     img: 'rob',\n//     countryCode: 'uk',\n//   },\n//   scouse: {\n//     title: 'Scouse',\n//     img: 'scouse',\n//     countryCode: 'gb sct',\n//   },\n//   stevooo: {\n//     title: 'Stevooo',\n//     img: 'stevooo',\n//     countryCode: 'uk',\n//   },\n//   sunny: {\n//     title: 'Sunny',\n//     img: 'sunny',\n//     countryCode: 'uk',\n//   },\n//   will: {\n//     title: 'The Flying Scotsman',\n//     img: 'will',\n//     countryCode: 'bb',\n//   },\n//   vinnie: {\n//     title: 'Master of Weights and Measures',\n//     img: 'vinnie',\n//     countryCode: 'bb',\n//   }  \n// }\n\nfunction PackPage() {\n\n  const categories = useCollection<CategoryType>('categories', true)\n  \n  console.log('CATS', categories);\n\n  return (\n    <Container>\n      <List \n        title=\"Packs 🐺\" \n        items={categories} \n        renderItem={(item) => (\n          <ListItem>\n            <ListHeader>\n              {item.title}\n            </ListHeader>\n            <Link to={`/category/${item?.id}/stats`}> Stats</Link> \n            {console.log('DUMP', Object.keys(item.stats))}\n            {!item.stats || Object.keys(item.stats).length > 0 ? <> | <Link to={`/category/${item?.id}/cards`}> Cards</Link></> : null}<br/>\n            Author: {item.author}\n          </ListItem>\n      )}/>\n      <InputCreate/>\n    </Container>\n  )\n}\n\ntype CreatePropsType = {\n  category: {id: string; title?: string};\n}\n\n// function InputEdit({category}: CreatePropsType) {\n//   const [title, setTitle] = useState(category.title);\n\n//   function handleUpdate() {\n//     db.collection('categories').doc(category.id).set({...category, title});\n//   }\n\n//   return (\n//     <>\n//       <input \n//         value={title}\n//         onChange={e => {\n//           setTitle(e.target.value)\n//         }}\n//       />  \n//       <button onClick={handleUpdate}>Update</button>\n//     </>\n//   )\n// }\n\nfunction InputCreate() {\n  const [title, setTitle] = useState('');\n  const { user } = useAuthContext();\n\n  function handleCreate() {\n    if (title !== '') {\n      // db.collection('categories').add({title, stats: {}, cards: CARDS, author: user?.displayName})\n      db.collection('categories').add({title, stats: {}, cards: {}, group: 'public', author: user?.username})\n    }\n  }\n\n  return (\n    <Form>\n      <Form.Input>\n        <input \n          placeholder=\"New Pack Title eg 'Classic Pioneers'\"\n          value={title}\n          onChange={e => {\n            setTitle(e.target.value)\n          }}\n          required\n        />  \n      </Form.Input>\n      <Button color=\"blue\" onClick={handleCreate}>Create</Button>\n    </Form>\n  )\n}\n\nexport default PackPage;","import { useEffect, useState } from \"react\";\nimport {db, getCollection} from '../services/firestore';\n\nfunction useDcoument<T>(path: string, id: string, isSnapshot: boolean = false) {\n  const [data, setData] = useState<T>();\n  console.log('USE DOC', data);\n\n  useEffect(() => {\n    if (!path) return;\n\n    if (isSnapshot) {\n      return db.collection(path).doc(id).onSnapshot(snapshot => {\n        const data = snapshot.data() as T;\n        console.log('SNAP SHOT', data);\n        setData(data);\n      });\n    }\n  \n    async function fetchData() {\n      const doc = await getCollection(path).doc(id).get();         \n      const data = doc.data() as T;\n      console.log('FETCH DATA', data);\n      setData(data);\n    }\n\n    fetchData();\n  }, [])\n\n  return data;\n}\n\nexport default useDcoument;","import React, { useEffect, useState } from \"react\";\nimport { db } from '../services/firestore';\nimport useDocument from '../hooks/useDocument';\nimport { useParams } from 'react-router-dom';\nimport { CategoryType, StatType } from '../types';\nimport { Form, Button, Container } from 'semantic-ui-react'\nimport { TitleBar } from '../components/Layout';\nimport Loading from '../components/Loading';\nimport List, {ListItem} from '../components/List';\n\nfunction StatsPage() {\n\n  const { categoryId } = useParams<{ categoryId: string }>();\n  const category = useDocument<CategoryType>('categories', categoryId, true);\n  console.log('USE DOC RESULT', category);\n\n  if (!category) {\n    return (\n      <Loading/>\n    )\n  }\n\n  return (\n    <Container>\n      <TitleBar.Source>Stats</TitleBar.Source>\n      <p>Create the list of stats that will appear on each card.  Eg Strength or Skill</p>\n      <Form>\n        <InputCreate categoryId={categoryId} category={category} />\n        <hr/>\n        <br/>\n        {category.stats && Object.entries(category.stats)\n          .map(([statKey, stat]) => (\n          <InputEdit categoryId={categoryId} category={category} statKey={statKey} stat={stat} />\n        ))}\n      </Form>\n    </Container>\n  )\n}\n\nfunction InputEdit({ categoryId, category, statKey, stat }: any) {\n  const [title, setTitle] = useState(stat.title);\n\n  function handleUpdate() {\n    const updatedStat: { [id: string]: StatType } = {};\n    updatedStat[`stats.${statKey}`] = { title };\n    db.collection('categories').doc(categoryId).update(updatedStat);\n  }\n\n  function handleDelete() {\n    delete category.stats[statKey];\n    // Remove stat from each card\n    for (let cardKey in category.cards) {\n      delete category.cards[cardKey][statKey];\n    }\n    db.collection('categories').doc(categoryId).set(category);\n  }\n\n  return (\n    <>\n      <Form.Field>\n        <input\n          value={title}\n          onChange={e => {\n            setTitle(e.target.value);\n          }}\n        />\n      </Form.Field>\n      <Button color=\"blue\" onClick={handleUpdate}>Update</Button>\n      <Button color=\"red\" onClick={handleDelete}>Delete</Button>\n      <br/><br/>\n    </>\n  )\n}\n\nfunction InputCreate({ categoryId, category }: { categoryId: string; category: CategoryType }) {\n  const [title, setTitle] = useState<string>('');\n\n  function handleCreate() {\n    category.stats[title] = { title };\n    db.collection('categories').doc(categoryId).set(category);\n    setTitle('');\n  }\n\n  return (\n    <>\n      <Form.Field>\n        <input\n          value={title}\n          placeholder=\"New Stat\"\n          onChange={e => {\n            setTitle(e.target.value)\n          }}\n        />\n      </Form.Field>\n      <Button color=\"blue\" onClick={handleCreate}>Create</Button>\n      <br/><br/>\n    </>\n  )\n}\n\nexport default StatsPage;","import React, {useState} from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { Form, Button, Image } from 'semantic-ui-react'\nimport { storage } from \"../services/firestore\";\nimport styled from \"styled-components\";\nimport { CategoryType, CardType, CardsType } from '../types';\nimport { db } from '../services/firestore';\nimport { resolvePreset } from \"@babel/core\";\n\nconst Error = styled.div`\n  color: red;\n`;\n\ntype PropsType = {\n  categoryId: string;\n  category: CategoryType;\n  card?: CardType;\n  // imgUrl: string;\n  // setImgUrl: (url: string) => void;\n  // onUpload: (data: any) => void;\n  // onSubmit: (data: any) => void;\n}\n\n// type CardFormType = CardType & {\n  // img: any;\n// }\n\nfunction CardForm({categoryId, category, card}: PropsType) {\n  const  { register, errors, reset, handleSubmit } = useForm({defaultValues: card});\n  const [imgUrl, setImgUrl] = useState(card?.imgUrl || '');\n  console.log('!CARD2', card, !card);\n\n  // async function onSubmit(card: CardFormType) {\n  async function onSubmit(formData: any) {\n    formData['imgUrl'] = imgUrl;\n    const cardId = !card ? `card${Object.keys(category.cards).length + 1}` : card.id;\n    formData.id = cardId;\n    category.cards[cardId] = formData;\n    const result = await db.collection('categories').doc(categoryId).set(category);\n    console.log('RESULT', result);\n    if (!card) {\n      reset();\n    }\n  }\n\n  async function handleDelete() {\n    if (card) {\n      console.log('DELETE CARD?', card.id, card);\n      const updatedCateogry = JSON.parse(JSON.stringify(category));\n      const result = delete updatedCateogry['cards'][card.id];\n      console.log('CAT POST DELETE', updatedCateogry);\n      // const updatedCategory =\n      await db.collection('categories').doc(categoryId).set(updatedCateogry);\n    }\n  }\n\n  return (\n    <Form>\n      <Form.Field>\n        <label>Title</label>\n        <input\n          name=\"title\"\n          ref={register({ required: true })}\n        />\n        {errors.title && <Error>Title is required</Error>}\n      </Form.Field>\n      <br />\n      <Form.Field>\n        <label htmlFor=\"countryCode\">Country Code</label>\n        <select\n          name=\"countryCode\"\n          ref={register}\n        >\n          <option value=\"\">Select...</option>\n          <option value=\"bb\">Barbados</option>\n          <option value=\"fr\">France</option>\n          <option value=\"ru\">Russia</option>\n          <option value=\"gb sct\">Scotland</option>\n          <option value=\"uk\">UK</option>\n          <option value=\"us\">USA</option>\n          <option value=\"gb wls\">Wales</option>\n        </select>\n      </Form.Field>\n      <br />\n      <Form.Field>\n        <ImageField imgUrl={imgUrl} setImgUrl={setImgUrl} />\n      </Form.Field>\n      <br />\n      { Object.entries(category.stats).map(([statKey, stat]) => (\n        <>\n          <Form.Field>\n            <label htmlFor={statKey}>{stat.title}</label>\n            <input\n              placeholder={stat.title}\n              name={statKey}\n              type=\"number\"\n              ref={register({ required: true })}              \n            />\n            {errors[statKey] && <Error>{stat.title} is required</Error>}\n          </Form.Field>\n          <br />\n        </>\n      ))}\n      <Button color=\"blue\" onClick={handleSubmit(onSubmit)}>{card ? 'Update' : 'Create'}</Button>\n      {card && <Button color=\"red\" onClick={handleDelete}>Delete</Button>}\n    </Form>\n  );\n}\n\nexport default CardForm;\n\nfunction ImageField({imgUrl, setImgUrl}: any) {\n  const [file, setFile] = useState<any>(null);\n\n  function handleChange(e: any) {\n    setFile(e.target.files[0]);\n  }\n\n  function handleUpload(e: any) {\n    e.preventDefault();\n    console.log('FILE', typeof file, file);\n      const ts = Date.now();\n      const uploadTask = storage.ref(`/images/${file.name}`).put(file);\n      uploadTask.on(\"state_changed\", console.log, console.error, () => {\n        storage\n          .ref(\"images\")\n          .child(file.name)\n          .getDownloadURL()\n          .then((url) => {\n            setFile(null);\n            setImgUrl(url);\n          });\n      });\n  }\n\n  return (\n    <div>\n      <Image src={imgUrl} />\n      <input type=\"file\" onChange={handleChange} />\n      <Button primary disabled={!file} onClick={handleUpload}>Upload Image</Button>\n    </div>\n  );\n}","import React, { Component } from 'react'\nimport { CSVReader } from 'react-papaparse'\nimport { Button } from 'semantic-ui-react'\n\n\ntype PropsType = {\n  handleOnFileLoad: (data: any) => void;  \n}\n\nconst buttonRef: any = React.createRef()\n\nexport default function _CSVReader({handleOnFileLoad}: PropsType) {\n  const handleOpenDialog = (e: any) => {\n    // Note that the ref is set async, so it might be null at some point\n    if (buttonRef.current) {\n      buttonRef.current.open(e)\n    }\n  }\n\n  const handleOnError = (err: any) => {\n    console.log(err)\n  }\n\n  const handleOnRemoveFile = (data: any) => {\n    console.log('---------------------------')\n    console.log(data)\n    console.log('---------------------------')\n  }\n\n  const handleRemoveFile = (e: any) => {\n    // Note that the ref is set async, so it might be null at some point\n    if (buttonRef.current) {\n      buttonRef.current.removeFile(e)\n    }\n  }\n\n    return (\n      <CSVReader\n        ref={buttonRef}\n        onFileLoad={handleOnFileLoad}\n        onError={handleOnError}\n        noClick\n        noDrag\n        onRemoveFile={handleOnRemoveFile}\n      >\n        {({ file }: any) => (\n          <aside\n            style={{\n              display: 'flex',\n              flexDirection: 'row',\n              marginBottom: 10\n            }}\n          >\n            <div\n              style={{\n                borderWidth: 1,\n                borderStyle: 'solid',\n                borderColor: '#ccc',\n                lineHeight: 2.5,\n                marginTop: 5,\n                marginBottom: 5,\n                marginRight: 5,\n              }}\n            >\n              {file && file.name}\n            </div>\n            <Button\n              primary\n              onClick={handleOpenDialog}\n            >\n              Upload CSV File\n            </Button>            \n            {/* <Button\n              onClick={handleRemoveFile}\n            >\n              Remove\n            </Button> */}\n          </aside>\n        )}\n      </CSVReader>\n    )\n  }","import React, { useEffect, useState } from \"react\";\nimport { db } from '../services/firestore';\nimport useDocument from '../hooks/useDocument';\nimport { useParams } from 'react-router-dom';\nimport { CategoryType, CardType, CardsType } from '../types';\nimport { Form, Button, Container, Tab, Input, Image, Segment } from 'semantic-ui-react'\nimport { TitleBar } from '../components/Layout';\nimport Loading from '../components/Loading';\nimport CardForm from '../forms/CardForm';\nimport { storage } from \"../services/firestore\";\nimport CSVReader from '../components/CSVReader';\n\nconst IMG_NAMES = ['ant', 'ben', 'dan', 'didun', 'dt', 'grant', 'mike', 'morgan', 'nick', 'pearce', 'rob', 'scouse', 'stevooo', 'sunny', 'will', 'vinnie'];\n\nfunction CardsPage() {\n\n  const { categoryId } = useParams<{ categoryId: string }>();\n  const category = useDocument<CategoryType>('categories', categoryId);\n  const [error, setError] = useState<string|null>(null);\n  // const [imgUrl, setImgUrl] = useState(\"\");\n\n  // console.log('ING_URL', imgUrl);\n\n  if (!category) {\n    return (\n      <Loading />\n    )\n  }\n\n  async function handleOnFileLoad(data: any) {\n\n    try {\n      setError(null);\n      const [header, ...rows] = data;\n      const [title, ...statKeys] = header.data;\n\n      const stats = Object.fromEntries(statKeys.map((stat: string) => [stat, { title: stat }]));\n\n      const cards = rows.reduce((cards: any, row: any, i: number) => {\n        const [title, ...statValues] = row.data;\n        console.log(title, statValues);\n        const cardId = `card${i + 1}`;\n        cards[cardId] = { id: cardId, title };\n        statKeys.forEach((key: string, i: number) => {\n          cards[cardId][key] = statValues[i];\n        });\n        return cards;\n      }, {});\n      const result = await db.collection('categories').doc(categoryId).set({ title: category?.title, stats, cards });\n    } catch (e) {\n      console.error('Error uploading CSV', e);\n      setError('Error uploading CSV File.  Check the format.')\n    }\n  }\n\n  // async function onSubmit(card: CardFormType) {\n  //   console.log('CARD PAGE ONSUBMIT', card, imgUrl);\n  //   // const [img] = card.img;\n  //   card['imgUrl'] = imgUrl;\n  //   // return;\n  //   if (category && imgUrl) {\n  //     delete card.img;\n  //     category.cards[card.title] = card;\n  //     console.log('SET CATEGORY', category);\n  //     const result = await db.collection('categories').doc(categoryId).set(category);\n  //     console.log('RESULT', result);\n  //   }\n  // }  \n\n  const panes = [\n    {\n      menuItem: 'Create', render: () => (\n        <Container>\n          <CardForm categoryId={categoryId} category={category} />\n        </Container>\n      )\n    },\n    {\n      menuItem: `Edit (${Object.keys(category.cards).length})`, render: () => (\n        <Container>\n          <Form>\n            {Object.entries(category.cards)\n              .sort((a, b) => b[0].localeCompare(a[0]))\n              .reverse()\n              .map(([cardKey, card]) => (\n                // <InputEdit categoryId={categoryId} category={category} cardKey={cardKey} cardItem={card} />\n                <>\n                  <CardForm categoryId={categoryId} category={category} card={card} />\n                  <hr />\n                </>\n              ))}\n          </Form>\n        </Container>\n      )\n    },\n    {\n      menuItem: 'CSV Upload', render: () => (\n        <Container>\n          <br />\n          <h2>Example CSV Format</h2>\n          <Segment>\n            Title,Height,Strength,Skill,Weight<br />\n            Adam,170,8,5,79<br />\n            Ben,175,10,5,85<br />\n          </Segment>\n          <CSVReader\n            handleOnFileLoad={handleOnFileLoad}\n          // handleFileUpload={(data: any) => {\n          //   console.log();\n          //   const [header, ...rows] = data;\n          //   const [title, ...stats] = rows;\n          //   console.log('STATS', title, stats);  \n          // }}\n          />\n        </Container>\n      )\n    },\n  ];\n\n  return (\n    <>\n      {error && <Segment inverted color=\"red\">{error}</Segment>}\n      <TitleBar.Source>{category.title}</TitleBar.Source>\n      <Tab panes={panes} />\n    </>\n  );\n}\n\nfunction InputEdit({ categoryId, category, cardKey, cardItem }: { categoryId: string; category: CategoryType, cardKey: string, cardItem: CardType }) {\n  const [card, setCard] = useState<CardType>(cardItem);\n\n  const handleChange = (e: any) => {\n    setCard({\n      ...card,\n      [e.target.name]: e.target.value,\n    })\n  };\n\n  function handleUpdate() {\n    const updatedCard: { [id: string]: CardType } = {};\n    updatedCard[`cards.${cardKey}`] = card;\n    db.collection('categories').doc(categoryId).update(updatedCard);\n  }\n\n  function handleDelete() {\n    console.log('CAT PRE DELETE', category, cardKey);\n    delete category.cards[cardKey];\n    console.log('CAT POST DELETE', category);\n    db.collection('categories').doc(categoryId).set(category);\n  }\n\n  return (\n    <>\n      <br />\n      <Form.Field>\n        <Input\n          label=\"Title\"\n          name=\"title\"\n          value={card.title}\n          onChange={handleChange}\n          required\n        />\n      </Form.Field>\n      <div>\n        {card.imgUrl}\n      </div>\n      <Image src={card.imgUrl} />\n      <br />\n      {Object.entries(category.stats)\n        .sort((a, b) => b[0].localeCompare(a[0]))\n        .reverse()\n        .map(([statKey, stat]) => (\n          <>\n            <Form.Field>\n              <Input\n                label={stat.title}\n                name={statKey}\n                type=\"number\"\n                value={card[statKey]}\n                onChange={handleChange}\n                required\n              />\n            </Form.Field>\n            <br />\n          </>\n        ))}\n      <Button color=\"blue\" onClick={handleUpdate}>Update</Button>\n      <Button color=\"red\" onClick={handleDelete}>Delete</Button>\n      <br /><br />\n      <hr />\n    </>\n  )\n}\n\nfunction InputCreate({ categoryId, category }: { categoryId: string; category: CategoryType }) {\n  const [card, setCard] = useState<CardType>({\n    title: '',\n    countryCode: '',\n  });\n\n  const handleChange = (e: any) => {\n    if (e.target.value === '') return;\n    setCard({\n      ...card,\n      [e.target.name]: e.target.value,\n    })\n  };\n\n  async function handleCreate() {\n    category.cards[card.title] = card;\n    await db.collection('categories').doc(categoryId).set(category);\n    setCard({ title: '', countryCode: '' });\n  }\n\n  return (\n    <>\n      <br />\n      <Form.Field>\n        <Input\n          label=\"Title\" t\n          name=\"title\"\n          value={card.title}\n          onChange={handleChange}\n          required\n        />\n      </Form.Field>\n      <br />\n      <Form.Field>\n        <label htmlFor=\"countryCode\">Country Code</label>\n        <select\n          name=\"countryCode\"\n          value={card.countryCode}\n          onChange={handleChange}\n        >\n          <option value=\"\">Select...</option>\n          <option value=\"bb\">Barbados</option>\n          <option value=\"fr\">France</option>\n          <option value=\"ru\">Russia</option>\n          <option value=\"gb sct\">Scotland</option>\n          <option value=\"uk\">UK</option>\n          <option value=\"us\">USA</option>\n          <option value=\"gb wls\">Wales</option>\n        </select>\n      </Form.Field>\n      <br />\n      <Form.Field>\n        <label htmlFor=\"img\">Image</label>\n        <select\n          name=\"img\"\n          value={card.img}\n          onChange={handleChange}\n        >\n          <option value=\"\">Select...</option>\n          {IMG_NAMES.map(img => (\n            <option value={img}>{img}</option>\n          ))}\n        </select>\n      </Form.Field>\n      <br />\n      {Object.entries(category.stats).map(([statKey, stat]) => (\n        <>\n          <Form.Field>\n            <Input\n              label={stat.title}\n              name={statKey}\n              type=\"number\"\n              onChange={handleChange}\n              required\n            />\n          </Form.Field>\n          <br />\n        </>\n      ))}\n      <Button color=\"blue\" onClick={handleCreate}>Create</Button>\n      <br /><br />\n    </>\n  )\n}\n\nexport default CardsPage;","import React, { useState } from \"react\";\nimport { db } from '../services/firestore';\nimport { useAuthContext } from '../components/AuthProvider';\nimport useCollection from '../hooks/useCollection';\nimport { CategoryType, UserType, GameFormType } from '../types';\nimport { Form, Button, Container } from 'semantic-ui-react';\nimport Loading from '../components/Loading';\nimport { TitleBar } from '../components/Layout';\nimport { useHistory } from \"react-router-dom\";\nimport Can from '../auth/Can';\n\nfunction ChallengePage() {\n\n  const { user } = useAuthContext();\n  const history = useHistory();\n  const categories = useCollection<CategoryType>('categories');\n  const users = useCollection<any>('users');\n\n  const [form, setForm] = useState<GameFormType>({ categoryId: '', player2Id: '' });\n\n  const handleChange = (e: any) => {\n    setForm({\n      ...form,\n      [e.target.name]: e.target.value,\n    })\n  };\n\n  async function handleCreate() {\n    const category = categories && Object.values(categories).find(x => x.id === form.categoryId);\n    if (category && user) {\n      const p2User = users?.find(u => u.id === form.player2Id);\n      const doc = await db.collection('games').add({\n        pack: category,\n        p1Id: user.uid,\n        p1Username: user.username,\n        p2Id: form.player2Id,\n        p2Username: p2User.username,\n        p1TurnNumber: 0,\n        p2TurnNumber: 0,\n        turnNumber: 0,\n        created: Date.now(),\n      });\n      history.push(`/game/${doc.id}`);\n      // alert('CREATED GAME', doc));\n    }\n    // db.collection('forms').doc(categoryId).update(updatedCard);\n  }\n\n  console.log('CHALLENGE FORM', form);\n  console.log('CHALLENGE DATA', categories, users);\n\n  if (!categories || !users) {\n    return (\n      <Loading />\n    )\n  }\n\n  return (\n    <Container>\n      <TitleBar.Source>Challenge</TitleBar.Source>\n      <br /><br />\n      <Form>\n        <Form.Field>\n          <label htmlFor=\"player2Id\">Friend</label>\n          <select\n            name=\"player2Id\"\n            value={form.player2Id}\n            onChange={handleChange}\n          >\n            <option value=\"\">Select...</option>\n            {Object.values(users).map((x: UserType) => (\n              <option value={x.id}>{x.username}</option>\n            ))}\n          </select>\n        </Form.Field>\n        <Form.Field>\n          <label htmlFor=\"categoryId\">Pack</label>\n          <select\n            name=\"categoryId\"\n            value={form.categoryId}\n            onChange={handleChange}\n          >\n            <option value=\"\">Select...</option>\n            {Object.values(categories).map((pack: CategoryType) => (\n              <Can\n                role={user?.role}\n                perform=\"game:play\"\n                data={{\n                  packGroupId: pack?.group,\n                  userGroupIds: user?.groups,\n                }}                \n                yes={() => (\n                  <option value={pack.id}>{pack.title}</option>\n                )}\n              />              \n            ))}\n          </select>\n        </Form.Field>\n      </Form>\n      <br></br>\n      <Button color=\"red\" circular onClick={handleCreate}>Create New Game</Button>\n    </Container>\n  )\n}\n\nexport default ChallengePage;","import React from \"react\";\nimport { TitleBar } from '../components/Layout';\nimport {Container} from 'semantic-ui-react';\n\nfunction MembershipPage() {\n  return (\n    <Container>\n      <TitleBar.Source>Membership</TitleBar.Source>\n      <br/>\n      <h3>🍖 🍳  Ham &amp; Egger</h3>\n      <ul>\n        <li>Play top trumps with your friends</li>\n      </ul>\n      <h3>⭐  Gold</h3>\n      <ul>\n        <li>Play top trumps with your friends</li>\n        <li>Invite your friends to play custom packs</li>\n      </ul>      \n      <h3>👑  Platinium</h3>\n      <ul>\n        <li>Play top trumps with your friends</li>\n        <li>Invite your friends to play custom packs</li>\n        <li>Edit custom packs</li>\n      </ul>      \n      <h3>💎  Diamond</h3>\n      <ul>\n        <li>Play top trumps with your friends</li>\n        <li>Invite your friends to play custom packs</li>\n        <li>Edit custom packs</li>\n        <li>Create new custom packs</li>\n      </ul>      \n    </Container>\n  )\n}\n\nexport default MembershipPage;","import React from \"react\";\nimport useCollection from '../hooks/useCollection';\nimport { GameType } from '../types';\nimport List from '../components/List';\nimport {Footer} from '../components/Layout';\nimport SignOut from '../components/SignOut';\nimport { Button } from 'semantic-ui-react';\nimport { useHistory } from \"react-router-dom\";\nimport { useAuthContext } from '../components/AuthProvider';\nimport styled from \"styled-components\";\n\nconst WideButton = styled(Button)`\n  width: 100%;\n`;\n\nfunction GamesPage() {\n\n  const history = useHistory();\n  const {user} = useAuthContext();\n  const games = useCollection<any>('games', true);\n  const items = games?.filter((game: GameType) => {\n    // const p1CardCount = game?.turns[`turn${game.turnNumber}`]?.p1Cards?.length;\n    // const p2CardCount = game?.turns[`turn${game.turnNumber}`]?.p2Cards?.length;   \n    // const inProgress = p1CardCount !== 0 && p2CardCount !== 0;\n    const hasUser = user?.uid === game.p1Id || user?.uid === game.p2Id;\n    return hasUser; \n  })\n  .sort((a, b) => (b.created - a.created))\n  .map((game: GameType) => {\n    const p1CardCount = game.turns[`turn${game.turnNumber}`]?.p1Cards?.length;\n    const p2CardCount = game.turns[`turn${game.turnNumber}`]?.p2Cards?.length;\n    return {\n      title: `${game?.p1Username} (${p1CardCount}) vs ${game?.p2Username} (${p2CardCount})`,\n      description: `${game?.pack?.title}: Round ${game?.turnNumber}`,\n      url: `/game/${game?.id}`\n    }\n  });\n\n  return (\n    <>\n      <List title=\"Games 🚀\" items={items} user={user} />\n      <Footer>\n        <WideButton\n          color='red'\n          icon='add'\n          size='huge'\n          circular\n          onClick={() => history.push(`/challenge`)}\n       >\n         New Game\n       </WideButton>\n      </Footer>\n    </>\n  )\n}\n\nexport default GamesPage;","import React from 'react';\nimport { Table, Image, Flag} from 'semantic-ui-react';\nimport { CardType, StatsType, StatParamType } from '../types';\nimport ant from '../img/ant.jpeg';\nimport ben from '../img/ben.jpeg';\nimport dan from '../img/dan.jpeg';\nimport dt from '../img/dt.jpeg';\nimport didun from '../img/didun.jpeg';\nimport grant from '../img/grant.jpeg';\nimport mike from '../img/mike.jpeg';\nimport morgan from '../img/morgan.jpeg';\nimport nick from '../img/nick.jpeg';\nimport pearce from '../img/pearce.jpeg';\nimport rob from '../img/rob.jpeg';\nimport scouse from '../img/scouse.jpeg';\nimport stevooo from '../img/stevooo.jpeg';\nimport sunny from '../img/sunny.jpeg';\nimport will from '../img/will.jpeg';\nimport vinnie from '../img/vinnie.jpeg';\n\nexport type ImagesType = {\n  [id: string]: any;\n}\n\nconst images: ImagesType = {\n  ant, ben, dan, didun, dt, grant, mike, morgan, nick, pearce, rob, scouse, stevooo, sunny, will, vinnie\n}\n\ntype PlayerType = null | 1 | 2;\n\ntype CardPropType = {\n  card: CardType;\n  stats: StatsType;\n  selectedStatKey: string | null | undefined;\n  disabled: boolean;\n  player: PlayerType;\n  result: undefined | null | 0 | 1 | 2;\n  onSelectStat: (statKey: string) => void;\n}\n\nfunction Card(props: CardPropType) {\n  const { card, stats, selectedStatKey, player, result, disabled } = props;\n  return (\n    <Table celled unstackable\n      size=\"small\"\n      selectable={!disabled}\n      style={{ width: '80%', marginLeft: 5 }\n      }>\n      <Table.Header>\n        <Table.Row>\n          <Table.HeaderCell>{card.title.toUpperCase()}</Table.HeaderCell>\n          <Table.HeaderCell textAlign='center'>\n            {card.countryCode && <Flag name={card.countryCode} />}\n          </Table.HeaderCell>\n        </Table.Row>\n      </Table.Header>\n      <Table.Body>\n        <Table.Row>\n          <Table.Cell colSpan='2'>\n            <Image src={images[card.img] || card.imgUrl} fluid />\n          </Table.Cell>\n        </Table.Row>\n        {\n          Object.entries(stats)\n          .sort((a, b) => b[0].localeCompare(a[0]))\n          .reverse()\n          .map(([statKey, stat]) => { // @TODO sort by key\n            const { title } = stat;\n            const value = card[statKey];\n            return (\n              <Row\n                key={statKey}\n                statKey={statKey}\n                selectedKey={selectedStatKey}\n                title={title}\n                value={value}\n                result={result}\n                player={player}\n                onSelectStat={() => props.onSelectStat(statKey)}\n              />\n            )\n          })\n        }\n      </Table.Body>\n    </Table>\n  );\n}\n\ntype StatusType = 'positive' | 'negative' | 'warning';\n\ntype RowPropType = {\n  title: string;\n  value: string | number;\n  statKey: string;\n  selectedKey: string | null | undefined;\n  player: PlayerType;\n  result: undefined | null | 0 | 1 | 2;\n  onSelectStat: (statKey: string) => void;\n}\n\nfunction Row(props: RowPropType) {\n  const {title, value, statKey, selectedKey, onSelectStat, result, player} = props;\n  let isActive = false;\n  let status: StatusType | undefined;\n  if (statKey === selectedKey && result == null) {\n    isActive = true; \n  } else if (statKey === selectedKey && result === 0) {\n    status = 'warning';\n  } else if (statKey === selectedKey && result === player) {\n    status = 'positive';\n  } else if (statKey === selectedKey && result !== player) {\n    status = 'negative';\n  } else {\n    status = undefined;\n  }\n  console.log('ACTIVE', selectedKey === statKey, selectedKey, statKey);\n  return (\n    <Table.Row key={statKey} onClick={onSelectStat} active={isActive}>\n      <Cell status={status}>\n        {title}\n      </Cell>\n      <Cell status={status}>\n        {value}\n      </Cell>\n    </Table.Row>\n  )\n}\n\ntype CellPropType = {\n  status?: StatusType;\n  children: any;\n}\n\nfunction Cell(props: CellPropType) {\n  const { status, children } = props;\n  return (\n    <Table.Cell\n      positive={status === 'positive'}\n      negative={status === 'negative'}\n      warning={status === 'warning'}\n    >\n      {children}\n    </Table.Cell>\n  );\n}\n\nexport default Card;","import React, { useEffect, useCallback, useState } from \"react\";\nimport {useParams} from 'react-router-dom';\nimport {db} from '../services/firestore';\nimport useDocument from '../hooks/useDocument';\nimport {CardsType, GameType, StatParamType} from '../types';\nimport Card from '../components/Card';\nimport { useAuthContext } from '../components/AuthProvider';\nimport {TitleBar, Footer} from '../components/Layout';\nimport { Button, Container } from 'semantic-ui-react';\nimport Loading from '../components/Loading';\nimport styled from 'styled-components';\n\nconst WideButton = styled(Button)`\n  width: 100%;\n`\n\nfunction useGame(gameId: string) {\n\n  const game = useDocument<GameType>('games', gameId, true);\n  const stats = game?.pack.stats;\n  const [error, setError] = useState<string>();\n\n  // console.log('GAME', gameId, game);\n\n  // CURRENT PLAYER\n  const {user} = useAuthContext();\n  const uid = user?.uid;\n  let currentPlayer: null|1|2 = null;\n  let currentUsername;\n  let opponentUsername;\n  if (game?.p1Id === uid) {\n    currentPlayer = 1;\n    currentUsername = game?.p1Username;\n    opponentUsername = game?.p2Username;\n  } else if (game?.p2Id === uid) {\n    currentPlayer = 2;\n    currentUsername = game?.p2Username;\n    opponentUsername = game?.p1Username;\n  }\n  //  else {\n  //   currentPlayer = 1;\n  //   game && setError('You are not a player in this game!')\n  // }\n  const startingPlayer = Math.floor(Math.random() * 2) + 1;\n\n  // Shuffle and deal cards - should be a serverless cloud function but that requires a Blaze payment plan :(\n  useEffect(() => {\n    const cards = game?.pack?.cards;\n    const turns = game?.turns;\n    if (!cards || turns) return;\n    const [p1Cards, p2Cards] = deal(cards);\n    async function updateCards() {\n      await db.collection('games').doc(gameId).update({\n        turnNumber: 1,\n        p1TurnNumber: 1,\n        p2TurnNumber: 1,\n        \"turns.turn1\":  {\n          id: 1,\n          player: 1,\n          // player: startingPlayer,\n          p1Cards, \n          p2Cards,\n          drawCards: [],\n          statKey: null,\n          result: null,\n        }  \n      });\n    }\n    updateCards();    \n  }, [gameId, game]);  // @TODO change game to cards\n\n  // TURN\n  let turnNumber = game?.turnNumber;\n  const playerTurnNumber: number = game ? game[`p${currentPlayer}TurnNumber`] : 1;\n\n  let [currentTurn, setCurrentTurn] = useState<number>(playerTurnNumber); // rename to playerTurn\n  if (currentTurn !== playerTurnNumber) {\n    setCurrentTurn(playerTurnNumber);\n  }\n\n  const handleNextTurn = useCallback(() => {\n    const nextTurn = currentTurn+1;\n    if (nextTurn > turnNumber) {\n      console.log('HANDLE NEXT TURN STOP?', nextTurn, turnNumber);\n      // return null;\n    }\n    async function updateTurn() {\n      await db.collection('games').doc(gameId).update({\n        [`p${currentPlayer}TurnNumber`]: nextTurn,\n      });\n    }\n    updateTurn();   \n    setCurrentTurn(nextTurn);\n  } , [currentTurn, currentPlayer]);\n  \n  if (!currentPlayer) {\n    console.error('PLAYER NOT FOUND');\n  }\n\n  const turn = game && getTurn(game, currentTurn);\n  const turnPlayer = turn?.player;\n  const p1Cards = game && getTurnCards(game, currentTurn, 1);\n  const p2Cards = game && getTurnCards(game, currentTurn, 2);\n  const drawCards = game && getTurnCards(game, currentTurn, 0);\n\n  console.log('DRAW CARDS', drawCards);\n\n  // STATS\n  const [selectedStat, setSelectedStat] = useState<string|null|undefined>(null);\n\n  const handleSelectStat = useCallback((statKey: string) => {\n    if (turnPlayer === currentPlayer) {\n      setSelectedStat(statKey); \n    } \n  }, [turnPlayer, currentPlayer]);\n\n  const handleTurn = useCallback(() => {\n    if (!selectedStat || p1Cards.length === 0 || p2Cards.length === 0) {\n      return null;\n    }\n    let result: number;\n    let p1UpdatedCards: string[];\n    let p2UpdatedCards: string[];\n    let drawUpdatedCards: string[] = [];\n\n    const statKey = selectedStat;\n    const [p1TopCard, ...p1HandCards] = p1Cards;\n    const [p2TopCard, ...p2HandCards] = p2Cards;\n    const p1Value = Number(game?.pack.cards[p1TopCard][statKey]);\n    const p2Value = Number(game?.pack.cards[p2TopCard][statKey]);\n\n    if (!p1Value || !p2Value) {\n      return null;\n    }\n\n    if (p1Value > p2Value) {\n      result = 1;\n      p1UpdatedCards = [...p1HandCards, p2TopCard, ...drawCards, p1TopCard];\n      p2UpdatedCards = [...p2HandCards]\n    } else if (p1Value < p2Value) {\n      result = 2;\n      p1UpdatedCards = [...p1HandCards];\n      p2UpdatedCards = [...p2HandCards, p1TopCard, ...drawCards, p2TopCard]\n    } else { // @TODO make first condition ===\n      result = 0;\n      p1UpdatedCards = [...p1HandCards];\n      p2UpdatedCards = [...p2HandCards]; \n      drawUpdatedCards = drawCards.length > 0 ? [...drawCards, p1TopCard, p2TopCard] : [p1TopCard, p2TopCard];\n    }\n\n    async function updateTurn() {\n      if (currentTurn == undefined) {\n        console.log('TURN COUNT UNDEFINED');\n        return null;\n      }\n      const nextTurn = currentTurn + 1;\n      const nextPlayer = result === 0 ? currentPlayer : result;\n      await db.collection('games').doc(gameId).update({\n        [`turns.turn${currentTurn}.statKey`]: statKey,\n        [`turns.turn${currentTurn}.result`]: result,\n        [`turns.turn${nextTurn}`]: {\n          id: nextTurn,\n          player: nextPlayer, \n          p1Cards: p1UpdatedCards,\n          p2Cards: p2UpdatedCards,\n          drawCards: drawUpdatedCards,\n          statKey: null,\n          result: null,\n        },\n        turnNumber: nextTurn,\n      });\n    }\n    updateTurn();\n    \n    setSelectedStat(null);\n\n  }, [selectedStat, game, p1Cards, p2Cards, drawCards, currentTurn]);\n\n  if (!game || !p1Cards || !p2Cards) return {game, turn, currentTurn, currentPlayer, topCards: [], handleSelectStat};\n  const [p1TopCardKey] = p1Cards; \n  const p1TopCard = game?.pack.cards[p1TopCardKey];\n  const [p2TopCardKey] = p2Cards; \n  const p2TopCard = game?.pack.cards[p2TopCardKey];\n  const topCards = [p1TopCard, p2TopCard];\n\n  const debug = {\n    turnId: turn?.id, \n    turnNo: game.turnNumber,\n    p1TurnNo: game.p1TurnNumber,\n    p2TurnNo: game.p2TurnNumber,\n    currentPlayer, \n    turnPlayer, \n    turn\n  };\n\n  console.table({turnId: turn?.id, \n    turnNo: game.turnNumber,\n    p1TurnNo: game.p1TurnNumber,\n    p2TurnNo: game.p2TurnNumber,\n    currentPlayer, \n    turnPlayer,\n  });\n  console.table(game?.turns);\n  \n  console.log(debug);\n\n  console.log((selectedStat && !turn?.result), selectedStat, !turn?.result);\n\n  return {game, error, turn, currentTurn, turnPlayer, currentPlayer, currentUsername, opponentUsername, topCards, selectedStat, handleSelectStat, handleTurn, handleNextTurn, debug};\n}\n\nfunction deal(items: CardsType) {\n  let hand1 = [];\n  let hand2 = [];\n  const cards = Object.keys(items);\n  const numCards = cards.length / 2;\n\n  for (let i = 0; i < numCards; i++) {\n   const index = Math.floor(Math.random() * numCards);\n   const [item] = cards.splice(index, 1);\n   hand1.push(item);\n  }\n  hand2 = cards;\n  return [hand1, hand2];\n}\n\nfunction getTurn(game: GameType, turn: number) {\n  if (!game.turns || turn === 0) return null;\n  const turnKey = `turn${turn}`;\n  return turnKey in game.turns ? game.turns[turnKey] : null;\n}\n\nfunction getTurnCards(game: GameType, turn: number, playerNum: null|0|1|2) {\n  if (!game.turns || turn === 0) return [];\n  if (playerNum === 0) return game.turns[`turn${turn}`][`drawCards`]; \n  console.log('TURN DUMP', turn);\n  return game.turns[`turn${turn}`][`p${playerNum}Cards`];\n}\n\nfunction GamePage() {\n\n  const {gameId} = useParams<{gameId:string}>();\n  // const gameId = 'HBqQxN5sDoLwqiGkABRu';\n\n  const {game, error, turn, currentTurn, turnPlayer, currentPlayer, currentUsername, opponentUsername, topCards, selectedStat, handleSelectStat, handleTurn, handleNextTurn, debug} = useGame(gameId);\n  const [p1TopCard, p2TopCard] = topCards;\n\n  const currentCard = currentPlayer === 1 ? p1TopCard : p2TopCard;\n  const opponentCard = currentPlayer === 1 ? p2TopCard : p1TopCard;\n  const statKey = turn?.statKey;\n\n  let resultMsg;\n  let currentEmoji;\n  let opponentEmoji;\n\n  if (turn?.result === currentPlayer) {\n    resultMsg = 'You won the round! ✅';\n    currentEmoji = '😃';\n    opponentEmoji = '😢';\n  } else if (turn?.result === 0) {\n    resultMsg = 'You drew the round! ↔️';\n    currentEmoji = '😮';\n    opponentEmoji = '😮';\n  } else if (turn?.result) {\n    resultMsg = 'You lost the round! ❌';\n    currentEmoji = '😢';\n    opponentEmoji = '😃';\n  }\n\n  const p1Color = currentPlayer === 1 ? 'red' : 'blue';\n  const p2Color = currentPlayer === 1 ? 'blue' : 'red';\n\n  if (!game) return (\n    <Loading/> \n  );\n\n  // if (error) return (\n  //   <Message username=\"Games Master\">{error}</Message>\n  // );  \n\n  if (!currentCard && !opponentCard) {\n    return (\n      <>\n        <TitleBar.Source>Game Over!</TitleBar.Source>\n        <Message username=\"Games Master\" color=\"green\">Good game! It's a draw! 🤷‍♂️</Message>\n      </>\n    )\n    } else if (!opponentCard) {\n    return (\n      <>\n        <TitleBar.Source>Game Over!</TitleBar.Source>\n        <Message username=\"Games Master\" color=\"green\">Good game! {currentUsername} wins! 🎉</Message>\n      </>\n    )\n  } else if (!currentCard) {\n    return (\n      <>\n        <TitleBar.Source>Game Over!</TitleBar.Source>\n        <Message username=\"Games Master\" color=\"green\">Good game! {opponentUsername} wins! ☠️</Message>\n      </>\n    )\n  }\n  return (\n    <Container>\n    <TitleBar.Source>Game On!</TitleBar.Source>\n    {currentPlayer === turnPlayer ? (\n      <Message username=\"Games Master\" color=\"green\">Round {currentTurn}. Your turn {currentUsername}. Tap that stat!</Message>\n    ) : (\n      <Message username=\"Games Master\" color=\"green\">Round {currentTurn}. {opponentUsername}'s turn.</Message>\n    )}\n    {statKey && (\n      <>\n        {currentPlayer === turnPlayer ? (\n          <>\n            <Message username={currentUsername} align=\"right\" color=\"CornflowerBlue\">{game.pack.stats[statKey].title}: {currentCard[statKey]}</Message>\n            <Message username={opponentUsername} color=\"orange\">{game.pack.stats[statKey].title}: {opponentCard[statKey]} {opponentEmoji}</Message>\n          </>\n        ) : (\n          <>\n            <Message username={opponentUsername} color=\"orange\">{game.pack.stats[statKey].title}: {opponentCard[statKey]}</Message>\n            <Message username={currentUsername} align=\"right\" color=\"CornflowerBlue\">{game.pack.stats[statKey].title}: {currentCard[statKey]} {currentEmoji}</Message>\n          </>\n        )}        \n      </>\n    )}         \n    {resultMsg && (\n      <Message username=\"Games Master\" color=\"green\">{resultMsg}</Message>\n    )}\n    { currentCard && \n      <Card \n        card={currentCard} \n        stats={game.pack.stats}\n        selectedStatKey={turn?.statKey || selectedStat}\n        player={currentPlayer}\n        result={turn?.result && turn.result} // TODO fix\n        onSelectStat={handleSelectStat}\n        disabled={(turn?.result != null || turnPlayer !== currentPlayer)}\n      />\n     }\n     {/* <pre>\n       {JSON.stringify(debug, null, 2)}\n     </pre>      */}\n     <Footer>\n        {selectedStat == null && (turn?.statKey == null && turn?.result == null) && ( \n        <>  \n        <Button\n          color={p1Color}\n          content={currentUsername}\n          icon='user'\n          label={{ basic: true, color: p1Color, pointing: 'left', content: turn?.p1Cards.length }}\n        />\n        <br/><br/>\n        <Button\n          color={p2Color}\n          content={opponentUsername}\n          icon='user'\n          label={{\n            basic: true,\n            color: p2Color,\n            pointing: 'left',\n            content: turn?.p2Cards.length,\n          }}\n        />  \n        </>      \n      )}        \n      {(selectedStat && currentTurn === game.turnNumber && currentPlayer === turnPlayer) && (\n        <WideButton circular color='red' icon='play' size='huge' onClick={handleTurn}>\n          Play Card\n        </WideButton>        \n      )}     \n      {(currentTurn < game.turnNumber && turn?.result != null) && ( \n        <WideButton circular color='red' icon='fast forward' size='huge' onClick={handleNextTurn}>\n          Next Round\n        </WideButton>           \n      )}    \n     </Footer>\n    </Container>\n  )\n}\n\nconst StyledMessage = styled.div<{align: 'left'|'right', color: string}>`\n  float: ${props => props.align === 'right' ? 'right' : 'left' };\n  width: 90%;\n  margin: 5px;\n  padding: 5px;\n  border-radius: ${props => props.align === 'right' ? '10px 0px 10px 10px' : '0px 10px 10px 10px' };\n  background: ${props => props.align === 'right' ? '#dcf8c6' : 'white' };\n  border: 1px solid grey;\n  color: ${props => props.color};\n`;\n\nfunction Message({username, children, align = 'left', color}: {username: string, children: any; align?: 'left'|'right', color: string}) {\n  return (\n    <StyledMessage align={align} color={color}>\n      <b>{username}:</b><br/>\n      <span style={{color: 'black'}}>{children}</span>\n    </StyledMessage>\n  )  \n}\n\nexport default GamePage;","import React from \"react\";\nimport { TitleBar } from '../components/Layout';\nimport {Container} from 'semantic-ui-react';\n\nfunction AboutPage() {\n\n  return (\n    <Container>\n      <TitleBar.Source>About 👾</TitleBar.Source>\n      <h2>Custom Top Trumps</h2>\n      <p>© Digital Crusade 2020</p>\n      {/* <p>You can create your own pack of cards with custom stats and play your friends in realtime or by correspondence.</p> */}\n      <p>If you have any suggestion for improvments or bug reports please WhatsApp or email <a href=\"mailto:djthomson@gmail.com\">DT</a></p>\n      <h3>Alpha Release v0.1.0 - 22/11/2020</h3>\n      <h4>What's new</h4>\n      <ul>\n        <li>User Authentication</li>\n        <li>Enable 2 player mode with realtime updates</li>\n        <li>Create and manage card packs</li>\n        <li>WhatsApp mobile theme</li>\n      </ul>\n      <h3>Alpha Release v0.2.0 - 23/11/2020</h3>\n      <h4>What's new</h4>\n      <ul>\n        <li>Facebook login</li>\n        <li>Show profile picture on friends list</li>\n      </ul>\n      <h4>Improvements</h4>\n      <ul>\n        <li>Made it easier to create pioneer packs.  Just add the stats and fill them out!</li>\n        <li>Login screen UX</li>\n      </ul>\n      <h4>Fixes</h4>\n      <ul>\n        <li>Confirmation email redirect</li>\n      </ul>       \n    </Container>\n  )\n}\n\nexport default AboutPage;","import React from \"react\";\nimport { Route, Switch, Link, Redirect } from \"react-router-dom\";\nimport AuthRoute from './AuthRoute';\nimport { useAuthContext } from './AuthProvider';\nimport SignUp from './SignUp';\nimport SignIn from './SignIn';\nimport SignOut from './SignOut';\n// import Game from './Game.txt';\nimport FriendsPage from '../pages/FriendsPage';\nimport PackPage from '../pages/PackPage';\nimport StatsPage from '../pages/StatsPage';\nimport CardsPage from '../pages/CardsPage';\nimport ChallengePage from '../pages/ChallengePage';\nimport MembershipPage from '../pages/MembershipPage';\nimport GameListPage from '../pages/GamesPage';\nimport GamePage from '../pages/GamePage';\nimport AboutPage from '../pages/AboutPage';\nimport List from '../components/List';\nimport {Footer} from '../components/Layout';\nimport { useHistory } from \"react-router-dom\";\nimport { Container, Button } from 'semantic-ui-react';\nimport ImageUpload from '../components/ImageUpload';\nimport CardForm from '../forms/CardForm';\nimport Can from '../auth/Can';\nimport { HeaderRightLink } from '../components/Layout';\nimport styled from \"styled-components\";\n\nconst WideButton = styled(Button)` // @TODO DRY UP\n  width: 100%;\n`;\n\nfunction HomePage() {\n  const listItems = [\n    {title: 'Games', url: '/games', action:'games:visit'},\n    {title: 'Packs', url: '/categories', action:'packs:visit'},\n    {title: 'Friends', url: '/friends', action:'friends:visit'},\n    {title: 'About', url: '/about', action:'about:visit'},\n    {title: 'Membership', url: '/membership', action:'membership:visit'},\n  ];\n  const history = useHistory();\n  const { user } = useAuthContext();\n  console.log('DISPLAY NAME', user)\n\n  return (\n    <Container> \n      {/* {user.role !== 'visitor' && <p>Welcome {user.username}</p>} */}\n      {<p>Welcome {user.username}</p>}\n      <Can\n          role={user?.role}\n          perform=\"home-page:login\"\n          yes={() => (\n            <HeaderRightLink to=\"/signin\">LOG IN</HeaderRightLink>\n          )}\n          // no={() => (\n          //   <HeaderRightLink to=\"/signout\">LOG OUT</HeaderRightLink>\n          // )}\n      />     \n      <List title=\"Top Trumps\" items={listItems} user={user} />\n\n      {user.role !== 'visitor' && <SignOut/>}\n\n      <Can\n          role={user?.role}\n          perform=\"games:visit\"\n          yes={() => (\n            <Footer>\n              <WideButton\n                color='red'\n                icon='add'\n                size='huge'\n                circular\n                onClick={() => history.push(`/challenge`)}\n              >\n                New Game\n              </WideButton>\n            </Footer>\n          )}\n          // no={() => (\n          //   <HeaderRightLink to=\"/signout\">LOG OUT</HeaderRightLink>\n          // )}\n      />        \n\n    </Container> \n  )\n}    \n\nfunction Router() {\n  return (\n    <Switch>\n\n       {/* Public Routes */}\n      <Route path=\"/signup\" component={SignUp} />\n      <Route path=\"/signin\" component={SignIn} />\n      <Route path=\"/home\" component={HomePage} />\n      <Route path=\"/about\" component={AboutPage} />\n      <Route path=\"/membership\" component={MembershipPage} />\n\n       {/* Private Routes */}\n      <AuthRoute path=\"/friends\" component={FriendsPage} />\n      <AuthRoute path=\"/categories\" component={PackPage} />\n      <AuthRoute path=\"/challenge\" component={ChallengePage} />\n      <AuthRoute path=\"/games\" component={GameListPage} />\n      <AuthRoute path=\"/game/:gameId\" component={GamePage} />\n      <AuthRoute path=\"/category/:categoryId/stats\" component={StatsPage} />\n      <AuthRoute path=\"/category/:categoryId/cards\" component={CardsPage} />\n      <AuthRoute path=\"/signout\" component={SignOut} />\n\n      <Redirect from=\"/\" to=\"/home\" />\n    </Switch>\n  )\n};\n\nexport default Router;","import React, { useEffect } from \"react\";\nimport { BrowserRouter } from \"react-router-dom\";\n// import Layout from \"components/layout\";\nimport Router from \"./components/Router\";\nimport { signUp } from './services/firestore';\nimport SignUp from './components/SignUp';\nimport SignIn from './components/SignIn';\nimport Layout from './components/Layout';\nimport AuthProvider from './components/AuthProvider';\n\nfunction App() {\n\n  return (\n    <BrowserRouter>\n      {/* <Layout> */}\n      <AuthProvider>\n        <Layout>\n          <Router />\n        </Layout>\n      </AuthProvider>\n      {/* </Layout> */}\n    </BrowserRouter>\n  )\n};\n\nexport default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'semantic-ui-css/semantic.min.css'\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}